<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å¯çˆ±å¯å€¾</title>
  
  <subtitle>èŠ±å¼€æœ‰æœŸï¼Œäº‘èˆ’æœ‰æ„</subtitle>
  <link href="https://blog.keaikeqing.cn/rss.xml" rel="self"/>
  
  <link href="https://blog.keaikeqing.cn/"/>
  <updated>2025-12-12T06:45:56.000Z</updated>
  <id>https://blog.keaikeqing.cn/</id>
  
  <author>
    <name>å¯çˆ±å¯å€¾</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¿®å¤ Conda å¯¼è‡´çš„ PowerShell å¯åŠ¨ç¼“æ…¢</title>
    <link href="https://blog.keaikeqing.cn/2025/12/12/TechnicalNotes/PowerShellCondaFix/"/>
    <id>https://blog.keaikeqing.cn/2025/12/12/TechnicalNotes/PowerShellCondaFix/</id>
    <published>2025-12-12T06:45:56.000Z</published>
    <updated>2025-12-12T06:45:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¿®å¤-conda-å¯¼è‡´çš„-powershell-å¯åŠ¨ç¼“æ…¢">ä¿®å¤ Conda å¯¼è‡´çš„PowerShell å¯åŠ¨ç¼“æ…¢</h1><h2 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h2><p>æ¯æ¬¡å¯åŠ¨ PowerShellæ—¶éƒ½æœ‰æ˜æ˜¾çš„å¡é¡¿ï¼Œå¯åŠ¨æ—¶é—´é•¿è¾¾æ•°ç§’ã€‚ç»è¿‡æ’æŸ¥ï¼Œå‘ç°è¿™æ˜¯ç”±äº Condaçš„åˆå§‹åŒ–è„šæœ¬å¯¼è‡´çš„ã€‚</p><h2 id="åŸå› ">åŸå› </h2><p>åœ¨ä½¿ç”¨ <code>conda init</code> å‘½ä»¤é…ç½® PowerShell ç¯å¢ƒæ—¶ï¼ŒCondaä¼šå‘é…ç½®æ–‡ä»¶ï¼ˆProfileï¼‰ä¸­æ³¨å…¥ä¸€æ®µåˆå§‹åŒ–ä»£ç ã€‚è¿™æ®µä»£ç ä¼šåœ¨æ¯æ¬¡å¯åŠ¨PowerShell æ—¶ç«‹å³æ‰§è¡Œï¼ŒåŠ è½½æ•´ä¸ª Conda ç¯å¢ƒï¼Œä»è€Œæ‹–æ…¢å¯åŠ¨é€Ÿåº¦ã€‚</p><h2 id="æ’æŸ¥è¿‡ç¨‹">æ’æŸ¥è¿‡ç¨‹</h2><ol type="1"><li><p><strong>æµ‹è¯•å½“å‰å¯åŠ¨æ—¶é—´</strong> ä½¿ç”¨<code>Measure-Command</code> æµ‹è¯•åŠ è½½é…ç½®æ–‡ä»¶çš„å¯åŠ¨è€—æ—¶ï¼š</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">Measure-Command</span> <span class="token punctuation">&#123;</span> pwsh<span class="token punctuation">.</span>exe <span class="token operator">-</span>Command <span class="token string">"exit"</span> <span class="token punctuation">&#125;</span></code></pre><p>æµ‹è¯•ç»“æœæ˜¾ç¤ºéœ€è¦çº¦ 5 ç§’ã€‚</p></li><li><p><strong>æµ‹è¯•è£¸å¯åŠ¨æ—¶é—´</strong>æµ‹è¯•ä¸åŠ è½½é…ç½®æ–‡ä»¶ï¼ˆ<code>-NoProfile</code>ï¼‰çš„å¯åŠ¨è€—æ—¶ï¼š</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">Measure-Command</span> <span class="token punctuation">&#123;</span> pwsh<span class="token punctuation">.</span>exe <span class="token operator">-</span>NoProfile <span class="token operator">-</span>Command <span class="token string">"exit"</span> <span class="token punctuation">&#125;</span></code></pre><p>ç»“æœä»…éœ€ 0.5ç§’å·¦å³ã€‚å·¨å¤§çš„æ—¶é—´å·®å¼‚è¯å®äº†é—®é¢˜å‡ºåœ¨é…ç½®æ–‡ä»¶ï¼ˆProfileï¼‰çš„åŠ è½½è¿‡ç¨‹ä¸­ã€‚</p></li><li><p><strong>å®šä½é…ç½®æ–‡ä»¶</strong></p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token variable">$PROFILE</span> <span class="token punctuation">|</span> <span class="token function">Get-Member</span> <span class="token operator">-</span><span class="token function">Type</span> NoteProperty</code></pre></li><li><p><strong>åˆ†æé…ç½®æ–‡ä»¶å†…å®¹</strong> æ‰“å¼€é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯<code>CurrentUserAllHosts</code>ï¼‰ï¼Œæ‰¾åˆ° Conda æ³¨å…¥çš„ä»£ç å—ï¼š</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment">#region conda initialize</span><span class="token comment"># !! Contents within this block are managed by 'conda init' !!</span><span class="token keyword">If</span> <span class="token punctuation">(</span><span class="token function">Test-Path</span> <span class="token string">"xx\Scripts\conda.exe"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">(</span>&amp; <span class="token string">"xx\Scripts\conda.exe"</span> <span class="token string">"shell.powershell"</span> <span class="token string">"hook"</span><span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Out-String</span> <span class="token punctuation">|</span> ?<span class="token punctuation">&#123;</span><span class="token variable">$_</span><span class="token punctuation">&#125;</span> <span class="token punctuation">|</span> <span class="token function">Invoke-Expression</span><span class="token punctuation">&#125;</span><span class="token comment">#endregion</span></code></pre></li><li><p><strong>éªŒè¯å‡è®¾</strong>ä¸´æ—¶æ³¨é‡Šæ‰ä¸Šè¿°ä»£ç å—åï¼Œå†æ¬¡æµ‹è¯•å¯åŠ¨æ—¶é—´ï¼š</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">Measure-Command</span> <span class="token punctuation">&#123;</span> pwsh<span class="token punctuation">.</span>exe <span class="token operator">-</span>Command <span class="token string">"exit"</span> <span class="token punctuation">&#125;</span><span class="token function">Measure-Command</span> <span class="token punctuation">&#123;</span> pwsh<span class="token punctuation">.</span>exe <span class="token operator">-</span>NoProfile <span class="token operator">-</span>Command <span class="token string">"exit"</span> <span class="token punctuation">&#125;</span></code></pre><p>å‘ç°ä¸è£¸å¯åŠ¨æ—¶é—´åŸºæœ¬æŒå¹³ï¼Œç¡®è®¤è¯¥æ®µä»£ç æ˜¯æ€§èƒ½ç“¶é¢ˆçš„æ ¹æºã€‚</p></li></ol><h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h2><p>ç›´æ¥æ³¨é‡Šæ‰ä»£ç è™½ç„¶èƒ½è§£å†³å¯åŠ¨æ…¢çš„é—®é¢˜ï¼Œä½†ä¼šå¯¼è‡´æ— æ³•ä½¿ç”¨<code>conda</code> å‘½ä»¤ã€‚æ›´å¥½çš„æ–¹æ¡ˆæ˜¯å°†åŒæ­¥åˆå§‹åŒ–æ”¹ä¸º<strong>æ‡’åŠ è½½ï¼ˆLazyLoadingï¼‰</strong>ï¼šä»…åœ¨é¦–æ¬¡è¾“å…¥ <code>conda</code>å‘½ä»¤æ—¶æ‰æ‰§è¡Œåˆå§‹åŒ–é€»è¾‘ã€‚</p><p>æ³¨ï¼šåªéœ€å°†è„šæœ¬ä¸­çš„ xx.exe æ›¿æ¢ä¸ºä½ å®é™…çš„ conda å®‰è£…è·¯å¾„å³å¯ã€‚</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment">#region conda initialize</span><span class="token comment"># ===== é…ç½®ï¼šğŸ›‘ æ”¹ä¸ºå®é™…çš„ conda.exe è·¯å¾„ =====</span><span class="token variable">$script</span>:CondaExePath = <span class="token string">'xx\Scripts\conda.exe'</span><span class="token comment"># ===== ä¸»é€»è¾‘ =====</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Test-Path</span> <span class="token operator">-</span>LiteralPath <span class="token variable">$script</span>:CondaExePath <span class="token operator">-</span>PathType Leaf<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment"># çŠ¶æ€æ ‡è®°ï¼šé˜²æ­¢é€’å½’è°ƒç”¨</span>    <span class="token variable">$script</span>:CondaInitialized = <span class="token boolean">$false</span>        <span class="token comment"># å®šä¹‰æ ¸å¿ƒåˆå§‹åŒ–é€»è¾‘</span>    <span class="token keyword">function</span> Global:<span class="token function">Invoke-CondaInit</span> <span class="token punctuation">&#123;</span>        <span class="token comment"># åªæœ‰æœªåˆå§‹åŒ–æ—¶æ‰æ‰§è¡Œ hook é€»è¾‘</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">-not</span> <span class="token variable">$script</span>:CondaInitialized<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Write-Host</span> <span class="token string">"ğŸ”„ æ­£åœ¨åˆå§‹åŒ– Conda..."</span> <span class="token operator">-</span>ForegroundColor Cyan            <span class="token variable">$script</span>:CondaInitialized = <span class="token boolean">$true</span>                        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token comment"># 1. è·å– Hook è„šæœ¬ (å±è”½ stderr è­¦å‘Š)</span>                <span class="token variable">$hookOutput</span> = &amp; <span class="token variable">$script</span>:CondaExePath <span class="token string">'shell.powershell'</span> <span class="token string">'hook'</span> 2><span class="token variable">$null</span>                <span class="token variable">$exitCode</span> = <span class="token variable">$LASTEXITCODE</span>                                <span class="token comment"># 2. ä¸¥æ ¼æ£€æŸ¥ï¼šä»»ä½•å¼‚å¸¸ç›´æ¥æŠ¥é”™</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$exitCode</span> <span class="token operator">-ne</span> 0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">throw</span> <span class="token string">"Conda hook è¿›ç¨‹é€€å‡ºç å¼‚å¸¸: <span class="token variable">$exitCode</span>"</span> <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token namespace">[string]</span>::IsNullOrWhiteSpace<span class="token punctuation">(</span><span class="token variable">$hookOutput</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">throw</span> <span class="token string">"Conda hook è¿”å›ç©ºå†…å®¹"</span> <span class="token punctuation">&#125;</span>                                <span class="token comment"># 3. æ‰§è¡Œå®˜æ–¹ Hook</span>                <span class="token function">Invoke-Expression</span> <span class="token punctuation">(</span><span class="token variable">$hookOutput</span> <span class="token punctuation">|</span> <span class="token function">Out-String</span><span class="token punctuation">)</span>                               <span class="token comment"># 4. åŒé‡ä¿é™©ï¼šç¡®ä¿ Global ä½œç”¨åŸŸç”Ÿæ•ˆ</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$fn</span> = <span class="token function">Get-Command</span> conda <span class="token operator">-</span>CommandType <span class="token keyword">Function</span> <span class="token operator">-</span>ErrorAction Stop                    <span class="token function">Set-Item</span> <span class="token operator">-</span>Path <span class="token keyword">Function</span>:\Global:conda <span class="token operator">-</span>Value <span class="token variable">$fn</span><span class="token punctuation">.</span>ScriptBlock <span class="token operator">-</span>Force                <span class="token punctuation">&#125;</span>                <span class="token keyword">catch</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">throw</span> <span class="token string">"Hook æ‰§è¡Œåæœªæ£€æµ‹åˆ° conda å‡½æ•°ï¼Œç¯å¢ƒå¯èƒ½å·²æŸå"</span>                <span class="token punctuation">&#125;</span>                <span class="token function">Write-Host</span> <span class="token string">"âœ“ Conda åˆå§‹åŒ–æˆåŠŸ"</span> <span class="token operator">-</span>ForegroundColor Green            <span class="token punctuation">&#125;</span>            <span class="token keyword">catch</span> <span class="token punctuation">&#123;</span>                <span class="token comment"># å¤±è´¥å¤„ç†ï¼šé‡ç½®çŠ¶æ€å¹¶ç›´æ¥æŠ›å‡ºè‡´å‘½é”™è¯¯</span>                <span class="token variable">$script</span>:CondaInitialized = <span class="token boolean">$false</span>                <span class="token function">Write-Error</span> <span class="token string">"Conda åˆå§‹åŒ–å¤±è´¥: <span class="token function">$<span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span>Exception<span class="token punctuation">.</span>Message<span class="token punctuation">)</span></span>"</span> <span class="token operator">-</span>ErrorAction Stop            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token comment"># æ‰§è¡Œç”¨æˆ·å‘½ä»¤</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$args</span><span class="token punctuation">.</span>Count <span class="token operator">-gt</span> 0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            &amp; conda @args        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>        <span class="token comment"># åº”ç”¨ä»£ç†ï¼šæ‹¦æˆªé¦–æ¬¡è°ƒç”¨</span>    <span class="token function">Set-Item</span> <span class="token keyword">Function</span>:\Global:conda <span class="token operator">-</span>Value <span class="token punctuation">&#123;</span> <span class="token function">Invoke-CondaInit</span> @args <span class="token punctuation">&#125;</span> <span class="token operator">-</span>Force    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token comment"># è·¯å¾„é…ç½®é”™è¯¯çš„æŠ¥é”™é€»è¾‘</span>    <span class="token function">Write-Warning</span> <span class="token string">"æœªæ‰¾åˆ° Conda: <span class="token variable">$script</span>:CondaExePath"</span>        <span class="token keyword">function</span> Global:conda <span class="token punctuation">&#123;</span>        <span class="token function">Write-Error</span> <span class="token string">"Conda é…ç½®è·¯å¾„æ— æ•ˆ: <span class="token variable">$script</span>:CondaExePath"</span> <span class="token operator">-</span>ErrorAction Stop    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">#endregion</span></code></pre><h2 id="ä»£ç è§£é‡Š">ä»£ç è§£é‡Š</h2><p>å½“PowerShellå¯åŠ¨æ—¶ï¼š</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">PowerShell å¯åŠ¨    â†“<span class="token function">Set-Item</span> <span class="token keyword">Function</span>:\Global:conda <span class="token operator">-</span>Value <span class="token punctuation">&#123;</span> <span class="token function">Invoke-CondaInit</span> @args <span class="token punctuation">&#125;</span>    â†“æ­¤æ—¶ conda = <span class="token function">Invoke-CondaInit</span></code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>Set-Item Function:\Global:conda ...</code> ä¼šå°†conda å‘½ä»¤é‡å®šå‘åˆ°ä»£ç†å‡½æ•° <code>Invoke-CondaInit</code>ã€‚æ­¤æ—¶ï¼Œå½“ç¬¬ä¸€æ¬¡è°ƒç”¨ conda å‘½ä»¤æ—¶ï¼Œä¼šè§¦å‘ä»£ç†å‡½æ•°<code>Invoke-CondaInit</code>:</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">ç”¨æˆ·è¾“å…¥: conda <span class="token operator">-</span>V    â†“è°ƒç”¨ä»£ç†å‡½æ•° <span class="token function">Invoke-CondaInit</span>    â†“è¿›å…¥ <span class="token function">Invoke-CondaInit</span>    â†“æ‰§è¡Œå®˜æ–¹ Hook: <span class="token function">Invoke-Expression</span> <span class="token punctuation">(</span><span class="token variable">$hookOutput</span> <span class="token punctuation">|</span> <span class="token function">Out-String</span><span class="token punctuation">)</span>    â†“ã€å…³é”®ã€‘å®˜æ–¹ Hook ä¼šå®šä¹‰ä¸€ä¸ªæ–°çš„ conda å‡½æ•°ï¼    â†“<span class="token function">Set-Item</span> <span class="token operator">-</span>Path <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">(</span>ä»…ä½œä¸ºé˜²å¾¡æ€§æ£€æŸ¥ï¼Œé€šå¸¸å®˜æ–¹ Hook å·²ç»å°† conda å‡½æ•°ä½œç”¨åˆ°å…¨å±€<span class="token punctuation">)</span>    â†“æ­¤æ—¶ conda = å®˜æ–¹å‡½æ•°ï¼ˆè¦†ç›–äº†æˆ‘ä»¬çš„ä»£ç†ï¼‰    â†“&amp; conda @args  â† è°ƒç”¨çš„æ˜¯å®˜æ–¹å‡½æ•°    â†“ç”¨æˆ·å†è¾“å…¥: conda activate xxx    â†“è°ƒç”¨çš„æ˜¯ã€å®˜æ–¹ conda å‡½æ•°ã€‘ï¼Œä¸å†æ˜¯ä»£ç†    â†“<span class="token function">Invoke-CondaInit</span> æ°¸è¿œä¸ä¼šå†è¢«è°ƒç”¨</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¿®å¤-conda-å¯¼è‡´çš„-powershell-å¯åŠ¨ç¼“æ…¢&quot;&gt;ä¿®å¤ Conda å¯¼è‡´çš„
PowerShell å¯åŠ¨ç¼“æ…¢&lt;/h1&gt;
&lt;h2 id=&quot;é—®é¢˜æè¿°&quot;&gt;é—®é¢˜æè¿°&lt;/h2&gt;
&lt;p&gt;æ¯æ¬¡å¯åŠ¨ PowerShell
æ—¶éƒ½æœ‰æ˜æ˜¾çš„å¡é¡¿ï¼Œå¯åŠ¨æ—¶é—´é•¿è¾¾æ•°ç§’ã€‚ç»è¿‡æ’æŸ¥ï¼Œå‘ç°</summary>
      
    
    
    
    <category term="éšç¬”" scheme="https://blog.keaikeqing.cn/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>DNSã€ç«¯å£ã€å®‰å…¨ç»„ä¸åå‘ä»£ç†</title>
    <link href="https://blog.keaikeqing.cn/2025/12/10/Web/DNS%20%E7%AB%AF%E5%8F%A3%20%E5%AE%89%E5%85%A8%E7%BB%84%E4%B8%8E%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"/>
    <id>https://blog.keaikeqing.cn/2025/12/10/Web/DNS%20%E7%AB%AF%E5%8F%A3%20%E5%AE%89%E5%85%A8%E7%BB%84%E4%B8%8E%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/</id>
    <published>2025-12-10T14:34:40.000Z</published>
    <updated>2025-12-10T14:34:40.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="dnsç«¯å£å®‰å…¨ç»„ä¸åå‘ä»£ç†">DNSã€ç«¯å£ã€å®‰å…¨ç»„ä¸åå‘ä»£ç†</h1><h2 id="dnsåªè´Ÿè´£åŸŸå-ip-çš„æ˜ å°„">1. DNSï¼šåªè´Ÿè´£â€œåŸŸå â†’ IP çš„æ˜ å°„â€</h2><p>DNSï¼ˆåŸŸåè§£æï¼‰åªåšä¸€ä»¶äº‹ï¼š</p><pre class="language-none"><code class="language-none">xx.example.com â†’ æœåŠ¡å™¨å…¬ç½‘ IP</code></pre><p>å®ƒ<strong>ä¸æ¶‰åŠç«¯å£ã€ä¸æ¶‰åŠé˜²ç«å¢™ã€ä¸æ¶‰åŠå®‰å…¨ç­–ç•¥</strong>ã€‚ä½ åªæ˜¯å‘Šè¯‰å…¨çƒçš„ DNS æœåŠ¡å™¨ï¼š</p><blockquote><p>â€œè®¿é—®è¿™ä¸ªåŸŸåï¼Œè¯·å»æ‰¾è¿™å°æœåŠ¡å™¨ã€‚â€</p></blockquote><hr /><h2 id="ç«¯å£æœåŠ¡ç›‘å¬çš„ä½ç½®">2. ç«¯å£ï¼šæœåŠ¡ç›‘å¬çš„ä½ç½®</h2><p>æœåŠ¡å™¨ä¸Šçš„æ¯ä¸€ä¸ªæœåŠ¡ï¼Œéƒ½éœ€è¦ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œä¾‹å¦‚ï¼š</p><table><thead><tr><th>æœåŠ¡</th><th>é»˜è®¤ç«¯å£</th><th>æ˜¯å¦éœ€å¯¹å¤–å¼€æ”¾ï¼Ÿ</th></tr></thead><tbody><tr><td>HTTP</td><td>80</td><td>âœ” é€šå¸¸å¼€æ”¾</td></tr><tr><td>HTTPS</td><td>443</td><td>âœ” é€šå¸¸å¼€æ”¾</td></tr><tr><td>xx åç«¯</td><td>1234</td><td>âŒ ä¸éœ€è¦å¼€æ”¾</td></tr></tbody></table><p>å¦‚æœä½ çš„ xx è¿è¡Œåœ¨ï¼š<code>127.0.0.1:1234</code>ï¼Œé‚£ä¹ˆå®ƒåªå…è®¸<strong>æœ¬æœºè®¿é—®</strong>ã€‚å¤–ç½‘æ— è®ºå¦‚ä½•éƒ½æ— æ³•è®¿é—®è¿™ä¸ªç«¯å£ï¼Œå³ä½¿å®‰å…¨ç»„æ”¾è¡Œäº† 1234 ç«¯å£ã€‚</p><p>å¦‚æœä½ çš„ xx è¿è¡Œåœ¨ï¼š<code>0.0.0.0:1234</code>ï¼Œé‚£ä¹ˆå®ƒå…è®¸<strong>æ‰€æœ‰ IP è®¿é—®</strong>ã€‚ä½†æ˜¯ï¼Œæ˜¯å¦èƒ½ä»å¤–ç½‘è®¿é—®ï¼Œè¿˜è¦çœ‹å®‰å…¨ç»„ä¸­æ˜¯å¦æ”¾è¡Œäº† 1234 ç«¯å£ã€‚</p><hr /><h2 id="å®‰å…¨ç»„å†³å®šå¤–ç½‘èƒ½å¦è®¿é—®æŸä¸ªç«¯å£">3.å®‰å…¨ç»„ï¼šå†³å®šå¤–ç½‘èƒ½å¦è®¿é—®æŸä¸ªç«¯å£</h2><p>å®‰å…¨ç»„æ˜¯äº‘å‚å•†æä¾›çš„<strong>å…¥å£é˜²ç«å¢™</strong>ï¼Œå†³å®šå“ªäº›ç«¯å£å¯ä»¥ä»å¤–ç½‘è®¿é—®ã€‚ä¾‹å¦‚ï¼š</p><table><thead><tr><th>ç«¯å£</th><th>å®‰å…¨ç»„æ”¾è¡Œï¼Ÿ</th><th>å¤–ç½‘èƒ½è®¿é—®å—ï¼Ÿ</th></tr></thead><tbody><tr><td>80</td><td>âœ”</td><td>èƒ½</td></tr><tr><td>443</td><td>âœ”</td><td>èƒ½</td></tr><tr><td>1234</td><td>âŒ</td><td>ä¸èƒ½</td></tr></tbody></table><blockquote><p><strong>åªè¦ä½ çš„å®‰å…¨ç»„æ²¡æœ‰æ”¾è¡Œ 1234ï¼Œå³ä¾¿æœåŠ¡ç›‘å¬äº†0.0.0.0:1234ï¼Œå¤–ç½‘ä»ç„¶æ— æ³•è®¿é—®ã€‚</strong></p></blockquote><hr /><h2 id="åå‘ä»£ç†nginxæŠŠå¤–ç½‘è¯·æ±‚è½¬å‘ç»™å†…éƒ¨æœåŠ¡">4.åå‘ä»£ç†ï¼ˆNginxï¼‰ï¼šæŠŠå¤–ç½‘è¯·æ±‚è½¬å‘ç»™å†…éƒ¨æœåŠ¡</h2><p>åä»£è´Ÿè´£å°† 80/443 çš„è®¿é—®è½¬å‘åˆ°å†…éƒ¨ç«¯å£ï¼Œå¦‚ï¼š</p><pre class="language-none"><code class="language-none">https:&#x2F;&#x2F;xx.example.com       â†“Nginxï¼ˆç›‘å¬ 80&#x2F;443ï¼‰       â†“127.0.0.1:1234ï¼ˆxx åç«¯ï¼‰</code></pre><p>åå‘ä»£ç†çš„æ„ä¹‰æ˜¯ï¼š</p><ul><li>å¤–ç½‘ç”¨æˆ·åªéœ€è¦è®¿é—®åŸŸåï¼ˆ80/443ï¼‰</li><li>å†…éƒ¨æœåŠ¡å¯ä»¥éšè—åœ¨ä»»æ„ç«¯å£</li><li>åç«¯ç«¯å£æ— éœ€æš´éœ²ç»™å¤–ç½‘ï¼ˆæ›´å®‰å…¨ï¼‰</li></ul><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ<strong>åç«¯ç«¯å£ä¸ç”¨å¼€æ”¾</strong>ã€‚</p><hr /><h2 id="å¸¸è§é—®é¢˜">5. å¸¸è§é—®é¢˜</h2><p><strong>Q: é…ç½®äº†åä»£åï¼Œæˆ‘éœ€è¦åœ¨äº‘æœåŠ¡å™¨åå°å¼€å¯ 1234ç«¯å£å—ï¼Ÿ</strong></p><p><strong>A:</strong> <strong>å®Œå…¨ä¸éœ€è¦</strong>ã€‚ å› ä¸ºæµé‡æ˜¯å…ˆåˆ°è¾¾Nginx (443ç«¯å£)ï¼Œç„¶åç”± Nginx åœ¨æœåŠ¡å™¨<strong>å†…éƒ¨</strong>é€šè¿‡<code>localhost</code> è½¬å‘ç»™1234ã€‚å¤–éƒ¨é˜²ç«å¢™æ ¹æœ¬çœ‹ä¸åˆ°è¿™ä¸ªå†…éƒ¨è½¬å‘è¿‡ç¨‹ï¼Œæ‰€ä»¥ 1234ç«¯å£åº”å½“ä¿æŒå…³é—­çŠ¶æ€ã€‚</p><p><strong>Q:å¦‚ä½•æ£€æµ‹æˆ‘çš„æœåŠ¡æ˜¯å¦åªç›‘å¬åœ¨æœ¬åœ°ä»¥åŠæ˜¯å¦å¼€å¯ï¼Ÿ</strong></p><p><strong>A:</strong> <strong>ä½¿ç”¨ <code>netstat</code> æˆ–<code>ss</code> å‘½ä»¤æŸ¥çœ‹ç«¯å£ç›‘å¬çŠ¶æ€ï¼š</strong></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ä½¿ç”¨ netstat</span><span class="token function">sudo</span> <span class="token function">netstat</span> <span class="token parameter variable">-ltn</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token number">1234</span><span class="token comment"># ä½¿ç”¨ ss</span><span class="token function">sudo</span> ss <span class="token parameter variable">-ltn</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token number">1234</span><span class="token comment"># æ­£ç¡®çš„çŠ¶æ€ (åªå…è®¸æœ¬åœ°)</span>tcp  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">127.0</span>.0.1:1234   <span class="token number">0.0</span>.0.0:* LISTEN<span class="token comment"># å±é™©çš„çŠ¶æ€ (å…è®¸æ‰€æœ‰ IP)</span>tcp  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0.0</span>.0.0:1234     <span class="token number">0.0</span>.0.0:* LISTEN</code></pre><h2 id="æ€»ç»“">6. æ€»ç»“</h2><p>ä¸€å¼ ç®€å•çš„å…³ç³»å›¾</p><pre class="language-none"><code class="language-none">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚        ç”¨æˆ·è®¿é—®åŸŸå           â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â†“        DNSï¼šè§£æåŸŸå â†’ æœåŠ¡å™¨ IP                â†“â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚     Nginxï¼ˆç›‘å¬ 80 &#x2F; 443ï¼‰     â”‚â”‚  è´Ÿè´£æ¥æ”¶å¤–ç½‘è¯·æ±‚å¹¶åšåå‘ä»£ç† â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â†“     å†…éƒ¨æœåŠ¡ï¼ˆå¦‚ 127.0.0.1:1234ï¼‰</code></pre><p>å¦‚æœä½ ä½¿ç”¨ Nginx ä¸º xx æˆ–å…¶ä»–åç«¯ç¨‹åºåšåä»£ï¼š</p><ul><li>âœ” <strong>å¿…é¡»å¼€æ”¾çš„ç«¯å£ï¼š80 / 443</strong></li><li>âŒ <strong>ä¸éœ€è¦å¼€æ”¾çš„ç«¯å£ï¼š1234 ç­‰å†…éƒ¨ç«¯å£</strong></li><li>âœ” å†…éƒ¨æœåŠ¡ä¿æŒç›‘å¬ 127.0.0.1 æˆ– 0.0.0.0 å³å¯</li><li>âœ” <strong>åªè¦åšäº†åä»£ï¼Œåç«¯ç«¯å£å°±ä¸éœ€è¦å¼€æ”¾ï¼</strong></li></ul><p>ç”¨ä¸€å¥è¯æ€»ç»“ï¼š</p><blockquote><p><strong>DNSè´Ÿè´£æ‰¾æœåŠ¡å™¨ï¼Œå®‰å…¨ç»„æ§åˆ¶å¤–ç½‘è®¿é—®æƒé™ï¼Œç«¯å£å†³å®šæœåŠ¡ä½ç½®ï¼Œåä»£è´Ÿè´£æŠŠå¤–éƒ¨è¯·æ±‚è½¬å‘åˆ°å†…éƒ¨æœåŠ¡ã€‚å› æ­¤ï¼Œåä»£åçš„åç«¯ç«¯å£æ— éœ€å¯¹å¤–å¼€æ”¾ã€‚</strong></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;dnsç«¯å£å®‰å…¨ç»„ä¸åå‘ä»£ç†&quot;&gt;DNSã€ç«¯å£ã€å®‰å…¨ç»„ä¸åå‘ä»£ç†&lt;/h1&gt;
&lt;h2 id=&quot;dnsåªè´Ÿè´£åŸŸå-ip-çš„æ˜ å°„&quot;&gt;1. DNSï¼šåªè´Ÿè´£â€œåŸŸå â†’ IP çš„æ˜ å°„â€&lt;/h2&gt;
&lt;p&gt;DNSï¼ˆåŸŸåè§£æï¼‰åªåšä¸€ä»¶äº‹ï¼š&lt;/p&gt;
&lt;pre class=&quot;languag</summary>
      
    
    
    
    <category term="ç½‘ç«™æ­å»º" scheme="https://blog.keaikeqing.cn/categories/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>Pythonç³»åˆ—ä¹‹logging</title>
    <link href="https://blog.keaikeqing.cn/2025/03/18/Python/logging/"/>
    <id>https://blog.keaikeqing.cn/2025/03/18/Python/logging/</id>
    <published>2025-03-18T11:53:35.000Z</published>
    <updated>2025-03-19T08:53:35.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="logging">logging</h1><p>Pythonçš„loggingæ¨¡å—æä¾›äº†çµæ´»çš„æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯ç”¨äºè°ƒè¯•å’Œè®°å½•ç¨‹åºè¿è¡Œä¿¡æ¯ã€‚</p><h2 id="åŸºæœ¬é…ç½®">1 åŸºæœ¬é…ç½®</h2><p>å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°Pythonæ–‡ä»¶ä¸­ï¼Œä»¥é…ç½®æ—¥å¿—è®°å½•ï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> logging<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path<span class="token comment"># é…ç½®æ—¥å¿—æ–‡ä»¶è·¯å¾„</span>script_dir <span class="token operator">=</span> Path<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>parent  <span class="token comment"># è·å–å½“å‰è„šæœ¬æ‰€åœ¨ç›®å½•</span>log_file_path <span class="token operator">=</span> script_dir <span class="token operator">/</span> <span class="token string">'log_file.log'</span>  <span class="token comment"># åœ¨è„šæœ¬ç›®å½•ä¸‹åˆ›å»ºæ—¥å¿—æ–‡ä»¶</span><span class="token comment"># é…ç½®æ—¥å¿—</span>logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>    level<span class="token operator">=</span>logging<span class="token punctuation">.</span>DEBUG<span class="token punctuation">,</span>  <span class="token comment"># è®¾ç½®æ—¥å¿—çº§åˆ«</span>    <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s - %(levelname)s - %(message)s'</span><span class="token punctuation">,</span>  <span class="token comment"># è®¾ç½®æ—¥å¿—æ ¼å¼</span>    handlers<span class="token operator">=</span><span class="token punctuation">[</span>        logging<span class="token punctuation">.</span>StreamHandler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># è¾“å‡ºåˆ°æ§åˆ¶å°</span>        logging<span class="token punctuation">.</span>FileHandler<span class="token punctuation">(</span>log_file_path<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>  <span class="token comment"># åŒæ—¶è¾“å‡ºåˆ°æ–‡ä»¶</span>    <span class="token punctuation">]</span><span class="token punctuation">)</span>logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>  <span class="token comment"># è·å–å½“å‰æ¨¡å—çš„logger</span><span class="token comment"># ä½¿ç”¨ç¤ºä¾‹ï¼šä¸åŒçº§åˆ«çš„æ—¥å¿—è®°å½•</span>logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span><span class="token string">"è¿™æ˜¯è°ƒè¯•ä¿¡æ¯"</span><span class="token punctuation">)</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"è¿™æ˜¯ä¸€èˆ¬ä¿¡æ¯"</span><span class="token punctuation">)</span> logger<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">"è¿™æ˜¯è­¦å‘Šä¿¡æ¯"</span><span class="token punctuation">)</span>logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"è¿™æ˜¯é”™è¯¯ä¿¡æ¯"</span><span class="token punctuation">)</span>logger<span class="token punctuation">.</span>critical<span class="token punctuation">(</span><span class="token string">"è¿™æ˜¯ä¸¥é‡é”™è¯¯ä¿¡æ¯"</span><span class="token punctuation">)</span></code></pre><h2 id="é«˜çº§é…ç½®">2 é«˜çº§é…ç½®</h2><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„æ—¥å¿—é…ç½®ç¤ºä¾‹ï¼Œä½œä¸ºæ¨¡å—ä½¿ç”¨ã€‚è¯¥ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªé€šç”¨çš„æ—¥å¿—é…ç½®ç±»ï¼Œæ”¯æŒå¤šæ¨¡å—å…±äº«æ—¥å¿—è®¾ç½®ã€æŒ‰å¤§å°è½®è½¬ã€å‹ç¼©æ—§æ—¥å¿—ã€ä¸åŒçº§åˆ«æ—¥å¿—åˆ†æ–‡ä»¶ã€æ§åˆ¶å°è¾“å‡ºå’Œè‡ªå®šä¹‰è¿‡æ»¤å™¨ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> logging<span class="token keyword">import</span> os<span class="token keyword">import</span> gzip<span class="token keyword">from</span> logging<span class="token punctuation">.</span>handlers <span class="token keyword">import</span> RotatingFileHandler<span class="token keyword">from</span> typing <span class="token keyword">import</span> Optional<span class="token punctuation">,</span> Dict<span class="token punctuation">,</span> List<span class="token keyword">import</span> shutil<span class="token keyword">class</span> <span class="token class-name">CompressedRotatingFileHandler</span><span class="token punctuation">(</span>RotatingFileHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""æ”¯æŒå‹ç¼©çš„æ—¥å¿—è½®è½¬å¤„ç†å™¨"""</span>    <span class="token keyword">def</span> <span class="token function">doRollover</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""é‡å†™doRolloveræ–¹æ³•æ¥æ·»åŠ å‹ç¼©åŠŸèƒ½"""</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>stream<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>stream <span class="token operator">=</span> <span class="token boolean">None</span>        <span class="token comment"># å¦‚æœå¤‡ä»½æ–‡ä»¶å·²å­˜åœ¨ï¼Œéœ€è¦å…ˆè½®è½¬è¿™äº›æ–‡ä»¶</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>backupCount <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token comment"># åˆ é™¤æœ€æ—§çš„ä¸€ä¸ªæ–‡ä»¶(å¦‚æœå­˜åœ¨)</span>            oldest_backup <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>baseFilename<span class="token punctuation">&#125;</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>backupCount<span class="token punctuation">&#125;</span></span><span class="token string">.gz"</span></span>            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>oldest_backup<span class="token punctuation">)</span><span class="token punctuation">:</span>                os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>oldest_backup<span class="token punctuation">)</span>            <span class="token comment"># è½®è½¬ç°æœ‰çš„å¤‡ä»½æ–‡ä»¶</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>backupCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                source <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>baseFilename<span class="token punctuation">&#125;</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">.gz"</span></span>                dest <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>baseFilename<span class="token punctuation">&#125;</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">&#125;</span></span><span class="token string">.gz"</span></span>                <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">:</span>                        os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>dest<span class="token punctuation">)</span>                    os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>source<span class="token punctuation">,</span> dest<span class="token punctuation">)</span>            <span class="token comment"># å‹ç¼©å½“å‰æ—¥å¿—ä¸ºç¬¬ä¸€ä¸ªå¤‡ä»½</span>            dest <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>baseFilename<span class="token punctuation">&#125;</span></span><span class="token string">.1.gz"</span></span>            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>self<span class="token punctuation">.</span>baseFilename<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>baseFilename<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_in<span class="token punctuation">:</span>                    <span class="token keyword">with</span> gzip<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_out<span class="token punctuation">:</span>                        shutil<span class="token punctuation">.</span>copyfileobj<span class="token punctuation">(</span>f_in<span class="token punctuation">,</span> f_out<span class="token punctuation">)</span>                os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>self<span class="token punctuation">.</span>baseFilename<span class="token punctuation">)</span>        <span class="token comment"># åˆ›å»ºæ–°çš„ç©ºæ—¥å¿—æ–‡ä»¶</span>        self<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">'w'</span>        self<span class="token punctuation">.</span>stream <span class="token operator">=</span> self<span class="token punctuation">.</span>_open<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">KeywordFilter</span><span class="token punctuation">(</span>logging<span class="token punctuation">.</span>Filter<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> keyword<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>keyword <span class="token operator">=</span> keyword    <span class="token keyword">def</span> <span class="token function">filter</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> record<span class="token punctuation">:</span> logging<span class="token punctuation">.</span>LogRecord<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bool</span><span class="token punctuation">:</span>        <span class="token comment"># ä»…å½“æ—¥å¿—æ¶ˆæ¯åŒ…å«ç‰¹å®šå…³é”®è¯æ—¶è¿”å› True</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>keyword <span class="token keyword">in</span> record<span class="token punctuation">.</span>msg<span class="token keyword">class</span> <span class="token class-name">LoggerConfig</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    é€šç”¨æ—¥å¿—é…ç½®ç±»ï¼Œæ”¯æŒå¤šæ¨¡å—å…±äº«æ—¥å¿—è®¾ç½®    ç‰¹æ€§ï¼š    1. æŒ‰å¤§å°è½®è½¬    2. æ—¥å¿—å‹ç¼©    3. ä¸åŒçº§åˆ«æ—¥å¿—åˆ†æ–‡ä»¶    4. æ”¯æŒæ§åˆ¶å°è¾“å‡º    5. æ”¯æŒè‡ªå®šä¹‰è¿‡æ»¤å™¨    """</span>    _instance <span class="token operator">=</span> <span class="token boolean">None</span>    _initialized <span class="token operator">=</span> <span class="token boolean">False</span>    _loggers<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> logging<span class="token punctuation">.</span>Logger<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> cls<span class="token punctuation">.</span>_instance <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            cls<span class="token punctuation">.</span>_instance <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span>LoggerConfig<span class="token punctuation">,</span> cls<span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>_instance    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>                 log_dir<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'./logs'</span><span class="token punctuation">,</span>                 log_level<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span>                 max_bytes<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>  <span class="token comment"># é»˜è®¤5MB</span>                 backup_count<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span>                 enable_console<span class="token punctuation">:</span> <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>                 compress_logs<span class="token punctuation">:</span> <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>                 custom_filters<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Dict<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span>                 extra_handlers<span class="token punctuation">:</span> List<span class="token punctuation">[</span>logging<span class="token punctuation">.</span>Handler<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        åˆå§‹åŒ–æ—¥å¿—é…ç½®        Args:            log_dir: æ—¥å¿—ç›®å½•            log_level: åŸºç¡€æ—¥å¿—çº§åˆ«            max_bytes: å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§å­—èŠ‚æ•°            backup_count: ä¿ç•™çš„å¤‡ä»½æ–‡ä»¶æ•°é‡            enable_console: æ˜¯å¦å¯ç”¨æ§åˆ¶å°è¾“å‡º            compress_logs: æ˜¯å¦å‹ç¼©æ—§æ—¥å¿—            custom_filters: è‡ªå®šä¹‰è¿‡æ»¤å™¨åˆ—è¡¨            extra_handlers: é¢å¤–çš„å¤„ç†å™¨åˆ—è¡¨        """</span>        <span class="token comment"># å•ä¾‹æ¨¡å¼ï¼šç¡®ä¿åªåˆå§‹åŒ–ä¸€æ¬¡</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>_initialized<span class="token punctuation">:</span>            <span class="token keyword">return</span>        self<span class="token punctuation">.</span>log_dir <span class="token operator">=</span> log_dir        self<span class="token punctuation">.</span>log_level <span class="token operator">=</span> log_level        self<span class="token punctuation">.</span>max_bytes <span class="token operator">=</span> max_bytes        self<span class="token punctuation">.</span>backup_count <span class="token operator">=</span> backup_count        self<span class="token punctuation">.</span>enable_console <span class="token operator">=</span> enable_console        self<span class="token punctuation">.</span>compress_logs <span class="token operator">=</span> compress_logs        self<span class="token punctuation">.</span>custom_filters <span class="token operator">=</span> custom_filters <span class="token keyword">or</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>extra_handlers <span class="token operator">=</span> extra_handlers <span class="token keyword">or</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token comment"># åˆ›å»ºæ—¥å¿—ç›®å½•</span>        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>log_dir<span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token comment"># é»˜è®¤æ ¼å¼åŒ–å™¨</span>        self<span class="token punctuation">.</span>default_formatter <span class="token operator">=</span> logging<span class="token punctuation">.</span>Formatter<span class="token punctuation">(</span>            <span class="token string">'%(asctime)s - %(name)s - %(levelname)s - %(message)s'</span>        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_initialized <span class="token operator">=</span> <span class="token boolean">True</span>    <span class="token keyword">def</span> <span class="token function">get_logger</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> formatter<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span>logging<span class="token punctuation">.</span>Formatter<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> logging<span class="token punctuation">.</span>Logger<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        è·å–æˆ–åˆ›å»ºlogger        Args:            name: loggeråç§°            formatter: è‡ªå®šä¹‰æ ¼å¼åŒ–å™¨        Returns:            logging.Logger: é…ç½®å¥½çš„logger        """</span>        <span class="token comment"># å¦‚æœå·²å­˜åœ¨è¯¥loggerï¼Œç›´æ¥è¿”å›</span>        <span class="token keyword">if</span> name <span class="token keyword">in</span> self<span class="token punctuation">.</span>_loggers<span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>_loggers<span class="token punctuation">[</span>name<span class="token punctuation">]</span>        <span class="token comment"># åˆ›å»ºlogger</span>        logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>name<span class="token punctuation">)</span>        <span class="token comment"># æ¸…ç†å¯èƒ½å­˜åœ¨çš„handlers</span>        <span class="token keyword">if</span> logger<span class="token punctuation">.</span>hasHandlers<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            logger<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># è®¾ç½®æ—¥å¿—çº§åˆ«</span>        logger<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>self<span class="token punctuation">.</span>log_level<span class="token punctuation">)</span>        formatter <span class="token operator">=</span> formatter <span class="token keyword">or</span> self<span class="token punctuation">.</span>default_formatter        <span class="token comment"># æ·»åŠ æ§åˆ¶å°å¤„ç†å™¨</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>enable_console<span class="token punctuation">:</span>            console_handler <span class="token operator">=</span> logging<span class="token punctuation">.</span>StreamHandler<span class="token punctuation">(</span><span class="token punctuation">)</span>            console_handler<span class="token punctuation">.</span>setFormatter<span class="token punctuation">(</span>formatter<span class="token punctuation">)</span>            logger<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>console_handler<span class="token punctuation">)</span>        <span class="token comment"># ä¸ºä¸åŒçº§åˆ«åˆ›å»ºå•ç‹¬çš„æ—¥å¿—æ–‡ä»¶</span>        log_levels <span class="token operator">=</span> <span class="token punctuation">[</span>            <span class="token punctuation">(</span>logging<span class="token punctuation">.</span>DEBUG<span class="token punctuation">,</span> <span class="token string">'debug'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> <span class="token string">'info'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span>logging<span class="token punctuation">.</span>WARNING<span class="token punctuation">,</span> <span class="token string">'warning'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span>logging<span class="token punctuation">.</span>ERROR<span class="token punctuation">,</span> <span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span>logging<span class="token punctuation">.</span>CRITICAL<span class="token punctuation">,</span> <span class="token string">'critical'</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span>        <span class="token keyword">for</span> level<span class="token punctuation">,</span> level_name <span class="token keyword">in</span> log_levels<span class="token punctuation">:</span>            <span class="token keyword">if</span> level <span class="token operator">>=</span> self<span class="token punctuation">.</span>log_level<span class="token punctuation">:</span>                handler <span class="token operator">=</span> self<span class="token punctuation">.</span>_create_rotating_handler<span class="token punctuation">(</span>                    os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>log_dir<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"LOG_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>level_name<span class="token punctuation">&#125;</span></span><span class="token string">.log"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>                    formatter<span class="token punctuation">,</span>                    level                <span class="token punctuation">)</span>                logger<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>handler<span class="token punctuation">)</span>        <span class="token comment"># æ·»åŠ é¢å¤–çš„å¤„ç†å™¨</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>extra_handlers<span class="token punctuation">:</span>            <span class="token keyword">for</span> handler <span class="token keyword">in</span> self<span class="token punctuation">.</span>extra_handlers<span class="token punctuation">:</span>                handler<span class="token punctuation">.</span>setFormatter<span class="token punctuation">(</span>formatter<span class="token punctuation">)</span>                logger<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>handler<span class="token punctuation">)</span>        <span class="token comment"># æ·»åŠ è‡ªå®šä¹‰è¿‡æ»¤å™¨</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>custom_filters<span class="token punctuation">:</span>            <span class="token keyword">for</span> filter_config <span class="token keyword">in</span> self<span class="token punctuation">.</span>custom_filters<span class="token punctuation">:</span>                filter_class <span class="token operator">=</span> filter_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'filter_class'</span><span class="token punctuation">)</span>                args <span class="token operator">=</span> filter_config<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'args'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> filter_class<span class="token punctuation">:</span>                    filter_instance <span class="token operator">=</span> filter_class<span class="token punctuation">(</span><span class="token operator">**</span>args<span class="token punctuation">)</span>                    logger<span class="token punctuation">.</span>addFilter<span class="token punctuation">(</span>filter_instance<span class="token punctuation">)</span>        <span class="token comment"># ç¦æ­¢å‘çˆ¶loggerä¼ é€’æ—¥å¿—</span>        logger<span class="token punctuation">.</span>propagate <span class="token operator">=</span> <span class="token boolean">False</span>        <span class="token comment"># ç¼“å­˜loggerå®ä¾‹</span>        self<span class="token punctuation">.</span>_loggers<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> logger        <span class="token keyword">return</span> logger    <span class="token keyword">def</span> <span class="token function">_create_rotating_handler</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>                                 filename<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span>                                 formatter<span class="token punctuation">:</span> logging<span class="token punctuation">.</span>Formatter<span class="token punctuation">,</span>                                 level<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> RotatingFileHandler<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        åˆ›å»ºè½®è½¬å¤„ç†å™¨        Args:            filename: æ—¥å¿—æ–‡ä»¶å            formatter: æ ¼å¼åŒ–å™¨            level: æ—¥å¿—çº§åˆ«        Returns:            RotatingFileHandler: é…ç½®å¥½çš„å¤„ç†å™¨        """</span>        handler_class <span class="token operator">=</span> CompressedRotatingFileHandler <span class="token keyword">if</span> self<span class="token punctuation">.</span>compress_logs <span class="token keyword">else</span> RotatingFileHandler        handler <span class="token operator">=</span> handler_class<span class="token punctuation">(</span>            filename<span class="token punctuation">,</span>            maxBytes<span class="token operator">=</span>self<span class="token punctuation">.</span>max_bytes<span class="token punctuation">,</span>            backupCount<span class="token operator">=</span>self<span class="token punctuation">.</span>backup_count<span class="token punctuation">,</span>            encoding<span class="token operator">=</span><span class="token string">'utf-8'</span>        <span class="token punctuation">)</span>        handler<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>level<span class="token punctuation">)</span>        handler<span class="token punctuation">.</span>setFormatter<span class="token punctuation">(</span>formatter<span class="token punctuation">)</span>        <span class="token keyword">return</span> handler<span class="token keyword">def</span> <span class="token function">setLogConfig</span><span class="token punctuation">(</span>module_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>                 log_dir<span class="token operator">=</span><span class="token string">'./logs'</span><span class="token punctuation">,</span>                 log_level<span class="token operator">=</span>logging<span class="token punctuation">.</span>DEBUG<span class="token punctuation">,</span>                 max_bytes<span class="token operator">=</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>  <span class="token comment"># 5MB</span>                 backup_count<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>                 enable_console<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                 compress_logs<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                 custom_filters<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>                 extra_handlers<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    å¿«é€Ÿè®¾ç½®å¹¶è·å–loggerçš„ä¾¿æ·å‡½æ•°    Args:        module_name: æ¨¡å—åç§°ï¼Œç”¨äºæ ‡è¯†æ—¥å¿—æ¥æº        log_dir: æ—¥å¿—ä¿å­˜ç›®å½•        log_level: æ—¥å¿—çº§åˆ«        max_bytes: å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§å­—èŠ‚æ•°        backup_count: ä¿ç•™çš„å¤‡ä»½æ–‡ä»¶æ•°é‡        enable_console: æ˜¯å¦å¯ç”¨æ§åˆ¶å°è¾“å‡º        compress_logs: æ˜¯å¦å‹ç¼©æ—§æ—¥å¿—        custom_filters: è‡ªå®šä¹‰è¿‡æ»¤å™¨åˆ—è¡¨ï¼Œä¾‹å¦‚custom_filters=[&#123;'filter_class': KeywordFilter, 'args': &#123;'keyword': 'critical'&#125;&#125;]        extra_handlers: é¢å¤–çš„å¤„ç†å™¨åˆ—è¡¨    Returns:        logging.Logger: é…ç½®å¥½çš„loggerå®ä¾‹    """</span>    <span class="token comment"># åˆå§‹åŒ–æ—¥å¿—é…ç½®</span>    log_config <span class="token operator">=</span> LoggerConfig<span class="token punctuation">(</span>        log_dir<span class="token operator">=</span>log_dir<span class="token punctuation">,</span>        log_level<span class="token operator">=</span>log_level<span class="token punctuation">,</span>        max_bytes<span class="token operator">=</span>max_bytes<span class="token punctuation">,</span>        backup_count<span class="token operator">=</span>backup_count<span class="token punctuation">,</span>        enable_console<span class="token operator">=</span>enable_console<span class="token punctuation">,</span>        compress_logs<span class="token operator">=</span>compress_logs<span class="token punctuation">,</span>        custom_filters<span class="token operator">=</span>custom_filters<span class="token punctuation">,</span>        extra_handlers<span class="token operator">=</span>extra_handlers    <span class="token punctuation">)</span>    <span class="token comment"># è‡ªåŠ¨è·å–è°ƒç”¨è€…çš„æ¨¡å—åç§°</span>    <span class="token keyword">if</span> module_name <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token keyword">import</span> inspect        caller_frame <span class="token operator">=</span> inspect<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        module_name <span class="token operator">=</span> caller_frame<span class="token punctuation">.</span>frame<span class="token punctuation">.</span>f_globals<span class="token punctuation">[</span><span class="token string">'__name__'</span><span class="token punctuation">]</span>        <span class="token comment"># å¦‚æœæ²¡æœ‰æä¾›module_nameï¼Œåˆ™é€šè¿‡è°ƒç”¨æ ˆè·å–è°ƒç”¨è€…çš„__name__</span>    <span class="token keyword">return</span> log_config<span class="token punctuation">.</span>get_logger<span class="token punctuation">(</span>name<span class="token operator">=</span>module_name<span class="token punctuation">,</span> formatter<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token comment"># ä½¿ç”¨ç¤ºä¾‹</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    logger <span class="token operator">=</span> setLogConfig<span class="token punctuation">(</span><span class="token string">'test_module'</span><span class="token punctuation">)</span>    <span class="token comment"># ä½¿ç”¨logger</span>    logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span><span class="token string">'è¿™æ˜¯ä¸€æ¡è°ƒè¯•æ—¥å¿—'</span><span class="token punctuation">)</span>    logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'è¿™æ˜¯ä¸€æ¡ä¿¡æ¯æ—¥å¿—'</span><span class="token punctuation">)</span>    logger<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">'è¿™æ˜¯ä¸€æ¡è­¦å‘Šæ—¥å¿—'</span><span class="token punctuation">)</span>    logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">'è¿™æ˜¯ä¸€æ¡é”™è¯¯æ—¥å¿—'</span><span class="token punctuation">)</span>    logger<span class="token punctuation">.</span>critical<span class="token punctuation">(</span><span class="token string">'è¿™æ˜¯ä¸€æ¡ä¸¥é‡é”™è¯¯æ—¥å¿—'</span><span class="token punctuation">)</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;logging&quot;&gt;logging&lt;/h1&gt;
&lt;p&gt;Pythonçš„loggingæ¨¡å—æä¾›äº†çµæ´»çš„æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œå¯ç”¨äºè°ƒè¯•å’Œè®°å½•ç¨‹åºè¿è¡Œä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2 id=&quot;åŸºæœ¬é…ç½®&quot;&gt;1 åŸºæœ¬é…ç½®&lt;/h2&gt;
&lt;p&gt;å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°Pythonæ–‡ä»¶ä¸­ï¼Œä»¥é…ç½®æ—¥å¿—è®°å½•ï¼š&lt;/p</summary>
      
    
    
    
    <category term="Python" scheme="https://blog.keaikeqing.cn/categories/Python/"/>
    
    
  </entry>
  
  <entry>
    <title>åšå®¢èµ„æºæ‰˜ç®¡æ–¹æ¡ˆ</title>
    <link href="https://blog.keaikeqing.cn/2025/03/03/Web/assets/"/>
    <id>https://blog.keaikeqing.cn/2025/03/03/Web/assets/</id>
    <published>2025-03-03T02:00:00.000Z</published>
    <updated>2025-03-03T02:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åšå®¢èµ„æºæ‰˜ç®¡æ–¹æ¡ˆ">åšå®¢èµ„æºæ‰˜ç®¡æ–¹æ¡ˆ</h1><h2 id="èµ„æºæ‰˜ç®¡æ–¹æ¡ˆ">èµ„æºæ‰˜ç®¡æ–¹æ¡ˆ</h2><p>åœ¨æ­å»ºåšå®¢æ—¶ï¼Œé€šå¸¸ä¼šæ¶‰åŠåˆ°ä¸€äº›é™æ€èµ„æºçš„æ‰˜ç®¡é—®é¢˜ï¼Œæ¯”å¦‚å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰ã€‚è¿™é‡Œåˆ—å‡ºå‡ ç§å¸¸è§çš„èµ„æºæ‰˜ç®¡æ–¹æ¡ˆï¼Œä¾›å‚è€ƒï¼š</p><table><colgroup><col style="width: 25%" /><col style="width: 25%" /><col style="width: 25%" /><col style="width: 25%" /></colgroup><thead><tr><th>æ ‡å·</th><th>æ–¹æ¡ˆ</th><th>å…·ä½“æ–¹æ³•</th><th>æ¨èæŒ‡æ•°</th></tr></thead><tbody><tr><td>1</td><td>æœ¬åœ°</td><td>æ”¾åœ¨åšå®¢sourceæ–‡ä»¶å¤¹ä¸‹ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œè·Ÿéšåšå®¢åŒæ­¥åˆ°githubä»“åº“</td><td>â˜…â˜…</td></tr><tr><td>2</td><td>github repo</td><td>å°†assetsèµ„æºæ”¾åœ¨å•ç‹¬çš„githubä»“åº“ç®¡ç†ï¼Œå¹¶æ‰“tag</td><td>â˜…â˜…â˜…</td></tr><tr><td>3</td><td>äº‘æœåŠ¡å™¨</td><td>å°†assetsæ”¾åœ¨äº‘æœåŠ¡å™¨é™æ€ç½‘é¡µä¸Š</td><td>â˜…â˜…â˜…â˜…</td></tr><tr><td>4</td><td>npm</td><td>å°†assetså‘å¸ƒåˆ°npmï¼Œç»è¿‡ unpkg/jsDelivr CDNä½¿ç”¨</td><td>â˜…â˜…â˜…â˜…</td></tr></tbody></table><h2 id="ä¼˜ç¼ºç‚¹åˆ†æ">ä¼˜ç¼ºç‚¹åˆ†æ</h2><h3 id="æœ¬åœ°">1 æœ¬åœ°</h3><ul><li>ä¼˜ç‚¹ï¼š<ul><li>æ–¹ä¾¿ï¼Œç›´æ¥æ”¾åœ¨åšå®¢çš„sourceæ–‡ä»¶å¤¹ä¸‹ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨å³å¯ã€‚</li><li>ä¸éœ€è¦é¢å¤–çš„é…ç½®å’Œç®¡ç†ã€‚</li><li>è·Ÿéšåšå®¢åŒæ­¥åˆ°githubä»“åº“ï¼Œæ–¹ä¾¿å¤‡ä»½å’Œç‰ˆæœ¬æ§åˆ¶ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>èµ„æºæ–‡ä»¶è¾ƒå¤§æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åšå®¢ä»“åº“è¿‡å¤§ï¼Œå½±å“å…‹éš†å’Œä¸‹è½½é€Ÿåº¦ã€‚</li><li>ä»“åº“å®¹é‡æœ‰é™ï¼Œè¶…è¿‡é™åˆ¶åä¹Ÿéš¾ä»¥æ¸…ç†ã€‚</li></ul></li></ul><h3 id="github-repo">2 github repo</h3><p>ä¸€èˆ¬é…åˆjsDelivrä½¿ç”¨ï¼ŒcdnåŠ é€Ÿã€‚</p><ul><li>ä¼˜ç‚¹ï¼š<ul><li>å¯ä»¥å°†assetsèµ„æºæ”¾åœ¨å•ç‹¬çš„githubä»“åº“ç®¡ç†ï¼Œé¿å…å½±å“åšå®¢ä»“åº“çš„å¤§å°ã€‚</li><li>å¯ä»¥ä½¿ç”¨githubçš„ç‰ˆæœ¬æ§åˆ¶å’Œå¤‡ä»½åŠŸèƒ½ï¼Œæ–¹ä¾¿ç®¡ç†å’Œç»´æŠ¤ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>éœ€è¦é¢å¤–çš„é…ç½®å’Œç®¡ç†ï¼Œå¢åŠ äº†å¤æ‚æ€§ã€‚</li><li>å¹¶ä¸æ¨ègithubåšèµ„æºæ‰˜ç®¡ï¼Œé™åˆ¶å¤§æ–‡ä»¶å’Œé«˜æµé‡è®¿é—®ï¼Œå°¤å…¶æ˜¯ç›´æ¥è°ƒç”¨raw.githubusercontent.comçš„èµ„æºã€‚</li></ul></li></ul><h3 id="äº‘æœåŠ¡å™¨">3 äº‘æœåŠ¡å™¨</h3><ul><li>ä¼˜ç‚¹ï¼š<ul><li>å¯ä»¥å°†assetsæ”¾åœ¨äº‘æœåŠ¡å™¨é™æ€ç½‘é¡µä¸Šï¼Œæ–¹ä¾¿ç®¡ç†å’Œç»´æŠ¤ã€‚</li><li>èµ„æºå®Œå…¨è‡ªç”±æŒæ§ï¼Œå¯ä»¥è®¾ç½®è®¿é—®æƒé™å’Œæµé‡é™åˆ¶ï¼Œéšç§æ€§æœ€å¥½ã€‚</li><li>å®¹é‡å’Œå¸¦å®½å–å†³äºäº‘æœåŠ¡å™¨çš„é…ç½®ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>éœ€è¦é¢å¤–çš„é…ç½®å’Œç®¡ç†ï¼Œå¢åŠ äº†å¤æ‚æ€§ã€‚</li><li>éœ€è¦æ”¯ä»˜äº‘æœåŠ¡å™¨çš„è´¹ç”¨ï¼Œå¢åŠ äº†æˆæœ¬ã€‚</li></ul></li></ul><h3 id="npm">4 npm</h3><ul><li>ä¼˜ç‚¹ï¼š<ul><li>å¯ä»¥å°†assetså‘å¸ƒåˆ°npmï¼Œç»è¿‡ unpkg/jsDelivr CDNä½¿ç”¨ï¼Œæ–¹ä¾¿å¿«æ·ã€‚</li><li>å¯ä»¥ä½¿ç”¨npmçš„ç‰ˆæœ¬æ§åˆ¶å’Œå¤‡ä»½åŠŸèƒ½ï¼Œæ–¹ä¾¿ç®¡ç†å’Œç»´æŠ¤ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>éœ€è¦é¢å¤–çš„é…ç½®å’Œç®¡ç†ï¼Œå¢åŠ äº†å¤æ‚æ€§ã€‚</li><li>èµ„æºæ›´æ–°åéœ€è¦é‡æ–°å‘å¸ƒåˆ°npm</li><li>åŒ…çš„å®¹é‡æœ‰é™åˆ¶</li></ul></li></ul><h3 id="æ€»ç»“">æ€»ç»“</h3><p>å°†èµ„æºåˆ†å¼€ç®¡ç†</p><ol type="1"><li>å°†é…ç½®æ–‡ä»¶æ”¾åœ¨sourceæ–‡ä»¶å¤¹ä¸‹ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨ã€‚</li><li>å°†ä¸å¸¸å˜åŠ¨çš„èµ„æºæ‰“åŒ…ä¸ºassetsï¼Œä¾æ®å–œå¥½æ”¾äºäº‘æœåŠ¡å™¨æˆ–è€…npm(ä½¿ç”¨jsDelivr/unpkgCDN)ã€‚</li><li>ç»å¸¸å˜åŠ¨çš„èµ„æºå¦‚æœè¾ƒå¤§ï¼Œæ”¾åœ¨äº‘æœåŠ¡å™¨æˆ–è€…githubrepo(ä½¿ç”¨jsDelivr)ä¸Šï¼Œå¦‚æœè¾ƒå°ï¼Œæ”¾åœ¨sourceæ–‡ä»¶å¤¹ä¸‹ã€‚</li><li>ååˆ†æ¨èä¸ºåšå®¢(å’Œäº‘æœåŠ¡å™¨ï¼Œå¦‚æœä½¿ç”¨çš„è¯)æ·»åŠ CloudflareCDNåŠ é€Ÿï¼Œå…è´¹ç‰ˆè¶³å¤Ÿä½¿ç”¨ã€‚</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åšå®¢èµ„æºæ‰˜ç®¡æ–¹æ¡ˆ&quot;&gt;åšå®¢èµ„æºæ‰˜ç®¡æ–¹æ¡ˆ&lt;/h1&gt;
&lt;h2 id=&quot;èµ„æºæ‰˜ç®¡æ–¹æ¡ˆ&quot;&gt;èµ„æºæ‰˜ç®¡æ–¹æ¡ˆ&lt;/h2&gt;
&lt;p&gt;åœ¨æ­å»ºåšå®¢æ—¶ï¼Œé€šå¸¸ä¼šæ¶‰åŠåˆ°ä¸€äº›é™æ€èµ„æºçš„æ‰˜ç®¡é—®é¢˜ï¼Œæ¯”å¦‚å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰ã€‚è¿™é‡Œåˆ—å‡ºå‡ ç§å¸¸è§çš„èµ„æºæ‰˜ç®¡æ–¹æ¡ˆï¼Œä¾›å‚è€ƒï¼š&lt;/p&gt;
&lt;table&gt;
&lt;colgro</summary>
      
    
    
    
    <category term="ç½‘ç«™æ­å»º" scheme="https://blog.keaikeqing.cn/categories/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>å†…å®¹åˆ†å‘ç½‘ç»œ (CDN)</title>
    <link href="https://blog.keaikeqing.cn/2025/02/26/TechnicalNotes/CDN/"/>
    <id>https://blog.keaikeqing.cn/2025/02/26/TechnicalNotes/CDN/</id>
    <published>2025-02-26T06:09:26.000Z</published>
    <updated>2025-09-11T01:40:26.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å†…å®¹åˆ†å‘ç½‘ç»œ-cdn">å†…å®¹åˆ†å‘ç½‘ç»œ (CDN)</h2><p>CDNï¼Œå…¨ç§° Content DeliveryNetworkï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼‰ï¼Œæ˜¯ä¸€ç§é€šè¿‡åˆ†å¸ƒå¼éƒ¨ç½²çš„æœåŠ¡å™¨ç½‘ç»œæ¥åŠ é€Ÿå’Œä¼˜åŒ–å†…å®¹ä¼ è¾“çš„æŠ€æœ¯ã€‚å®ƒçš„æ ¸å¿ƒç›®æ ‡æ˜¯è®©ç”¨æˆ·èƒ½å¤Ÿå°±è¿‘è·å–æ‰€éœ€çš„ç½‘é¡µã€è§†é¢‘ã€å›¾ç‰‡ã€è„šæœ¬ç­‰å†…å®¹ï¼Œä»è€Œæå‡è®¿é—®é€Ÿåº¦å’Œä½“éªŒï¼ŒåŒæ—¶å‡è½»æºç«™æœåŠ¡å™¨çš„å‹åŠ›ã€‚</p><h3 id="åŸç†">1 åŸç†</h3><ol type="1"><li>å†…å®¹ç¼“å­˜ä¸åˆ†å‘ (Caching &amp; Distribution):è¿™æ˜¯CDNæœ€åŸºç¡€ä¹Ÿæ˜¯æœ€å…³é”®çš„æŠ€æœ¯ã€‚CDNä¼šå°†ç½‘ç«™çš„é™æ€å†…å®¹ï¼ˆå¦‚å›¾ç‰‡ã€è§†é¢‘ã€CSS/JSæ–‡ä»¶ç­‰ï¼‰ä¸»åŠ¨æˆ–è¢«åŠ¨åœ°ä»æºç«™æœåŠ¡å™¨ç¼“å­˜åˆ°éå¸ƒå…¨çƒçš„è¾¹ç¼˜èŠ‚ç‚¹æœåŠ¡å™¨ä¸Šã€‚å½“ç”¨æˆ·å‘èµ·è®¿é—®è¯·æ±‚æ—¶ï¼Œè¯·æ±‚ä¼šè¢«å¼•å¯¼è‡³ç¦»ç”¨æˆ·åœ°ç†ä½ç½®æœ€è¿‘ã€ç½‘ç»œå»¶è¿Ÿæœ€ä½çš„è¾¹ç¼˜èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹ä¼šç›´æ¥å°†ç¼“å­˜çš„å†…å®¹å“åº”ç»™ç”¨æˆ·ï¼Œé¿å…äº†å¯¹æºç«™çš„ç›´æ¥è®¿é—®ï¼Œæå¤§åœ°ç¼©çŸ­äº†ç‰©ç†è·ç¦»å’Œæ•°æ®ä¼ è¾“æ—¶é—´ã€‚</li><li>è´Ÿè½½å‡è¡¡ä¸æ™ºèƒ½è°ƒåº¦ (Load Balancing &amp; Intelligent Scheduling):CDNæ‹¥æœ‰ä¸€ä¸ªæ™ºèƒ½çš„â€œå¤§è„‘â€â€”â€”å…¨å±€è´Ÿè½½å‡è¡¡ï¼ˆGSLBï¼‰ç³»ç»Ÿã€‚è¿™ä¸ªç³»ç»Ÿä¼šå®æ—¶ç›‘æ§æ‰€æœ‰è¾¹ç¼˜èŠ‚ç‚¹çš„å¥åº·çŠ¶å†µã€è´Ÿè½½æƒ…å†µä»¥åŠåˆ°ç”¨æˆ·çš„ç½‘ç»œé“¾è·¯è´¨é‡ã€‚å½“ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼ŒGSLBä¼šç»¼åˆåˆ†æç”¨æˆ·çš„IPåœ°å€ã€åœ°ç†ä½ç½®ã€è¿è¥å•†ç½‘ç»œç­‰ä¿¡æ¯ï¼Œé€šè¿‡DNSè§£ææˆ–HTTPé‡å®šå‘ç­‰æŠ€æœ¯ï¼Œå°†ç”¨æˆ·çš„è¯·æ±‚â€œè°ƒåº¦â€åˆ°æœ€ä¼˜çš„è¾¹ç¼˜èŠ‚ç‚¹ä¸Šï¼Œç¡®ä¿ç”¨æˆ·è·å¾—æœ€å¿«ã€æœ€ç¨³å®šçš„è®¿é—®ä½“éªŒã€‚</li></ol><h3 id="å·¥ä½œæµç¨‹">2 å·¥ä½œæµç¨‹</h3><p>ç”¨æˆ·ä½¿ç”¨CDNæœåŠ¡è®¿é—®ä¸€ä¸ªç½‘ç«™çš„å®Œæ•´æµç¨‹ï¼Œå¯ä»¥åˆ†è§£ä¸ºä»¥ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š</p><p><strong>å‰æï¼š</strong>ç½‘ç«™ä¸»å·²ç»å°†å…¶åŸŸåæ¥å…¥CDNæœåŠ¡ï¼Œå¹¶åœ¨DNSæœåŠ¡å•†å¤„å°†åŸŸåè§£ææŒ‡å‘CDNæœåŠ¡å•†æä¾›çš„CNAMEè®°å½•ã€‚</p><ol type="1"><li><strong>ç”¨æˆ·å‘èµ·è¯·æ±‚ï¼š</strong> å½“ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ç½‘å€ï¼ˆä¾‹å¦‚<code>www.example.com</code>ï¼‰åï¼Œè®¡ç®—æœºä¼šå‘æœ¬åœ°DNSæœåŠ¡å™¨ï¼ˆLocalDNSï¼‰å‘èµ·åŸŸåè§£æè¯·æ±‚ã€‚</li><li><strong>CNAMEè§£æè‡³CDNçš„DNSè°ƒåº¦ç³»ç»Ÿï¼š</strong> LocalDNSä»åŸŸåçš„æƒå¨DNSæœåŠ¡å™¨è·å–åˆ°è¯¥åŸŸåè¢«é…ç½®äº†ä¸€æ¡CNAMEè®°å½•ï¼ŒæŒ‡å‘äº†CDNæœåŠ¡å•†çš„åŸŸåï¼ˆä¾‹å¦‚<code>www.example.com.cdn.cloudflare.net</code>ï¼‰ã€‚äºæ˜¯ï¼ŒLocalDNSä¼šå†æ¬¡å‘CDNçš„DNSè°ƒåº¦ç³»ç»Ÿå‘èµ·è¯·æ±‚ã€‚</li><li><strong>æ™ºèƒ½è°ƒåº¦ï¼Œè¿”å›æœ€ä¼˜èŠ‚ç‚¹IPï¼š</strong>CDNçš„DNSè°ƒåº¦ç³»ç»Ÿï¼ˆå³GSLBï¼‰æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šæ ¹æ®ä¸€ç³»åˆ—ç­–ç•¥è¿›è¡Œæ™ºèƒ½å†³ç­–ï¼š<ul><li><strong>åœ°ç†ä½ç½®åˆ¤æ–­ï¼š</strong>åˆ†æç”¨æˆ·çš„IPåœ°å€ï¼Œåˆ¤æ–­å…¶æ‰€åœ¨çš„åœ°ç†ä½ç½®å’Œè¿è¥å•†ç½‘ç»œã€‚</li><li><strong>èŠ‚ç‚¹å¥åº·åº¦æ£€æµ‹ï¼š</strong>æ’é™¤æ‰æ•…éšœæˆ–è´Ÿè½½è¿‡é«˜çš„è¾¹ç¼˜èŠ‚ç‚¹ã€‚</li><li><strong>ç½‘ç»œè´¨é‡æ¢æµ‹ï¼š</strong>è¯„ä¼°å„ä¸ªèŠ‚ç‚¹åˆ°ç”¨æˆ·çš„ç½‘ç»œå»¶è¿Ÿå’Œä¸¢åŒ…ç‡ã€‚</li><li>ç»¼åˆä»¥ä¸Šä¿¡æ¯ï¼Œé€‰æ‹©å‡ºä¸€ä¸ªå¯¹è¯¥ç”¨æˆ·æ¥è¯´â€œæœ€ä¼˜â€çš„è¾¹ç¼˜èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶IPåœ°å€è¿”å›ç»™LocalDNSã€‚</li></ul></li><li><strong>è·å–æœ€ä¼˜èŠ‚ç‚¹IPï¼š</strong> LocalDNSå°†è·å–åˆ°çš„æœ€ä¼˜è¾¹ç¼˜èŠ‚ç‚¹çš„IPåœ°å€è¿”å›ç»™ç”¨æˆ·çš„è®¡ç®—æœºã€‚</li><li><strong>ç”¨æˆ·ä¸è¾¹ç¼˜èŠ‚ç‚¹å»ºç«‹è¿æ¥ï¼š</strong>ç”¨æˆ·çš„æµè§ˆå™¨å‘è¿™ä¸ªæœ€ä¼˜çš„è¾¹ç¼˜èŠ‚ç‚¹IPåœ°å€å‘èµ·HTTP/HTTPSè¯·æ±‚ï¼Œè¯·æ±‚è·å–å…·ä½“çš„ç½‘é¡µå†…å®¹ï¼ˆå¦‚ä¸€å¼ å›¾ç‰‡ï¼‰ã€‚</li><li><strong>è¾¹ç¼˜èŠ‚ç‚¹å“åº”ï¼š</strong><ul><li><strong>ç¼“å­˜å‘½ä¸­ï¼ˆCache Hitï¼‰ï¼š</strong>å¦‚æœè¯¥è¾¹ç¼˜èŠ‚ç‚¹å·²ç»ç¼“å­˜äº†ç”¨æˆ·è¯·æ±‚çš„å†…å®¹ï¼Œå¹¶ä¸”ç¼“å­˜å°šæœªè¿‡æœŸï¼Œå®ƒä¼šç›´æ¥å°†å†…å®¹å‘é€ç»™ç”¨æˆ·ã€‚è¿™æ˜¯æœ€ç†æƒ³ã€æœ€å¿«é€Ÿçš„æƒ…å†µã€‚</li><li><strong>ç¼“å­˜æœªå‘½ä¸­ï¼ˆCache Missï¼‰ï¼š</strong>å¦‚æœè¯¥èŠ‚ç‚¹æ²¡æœ‰ç¼“å­˜è¯¥å†…å®¹ï¼Œæˆ–è€…ç¼“å­˜å·²ç»è¿‡æœŸï¼Œå®ƒä¼šä»£è¡¨ç”¨æˆ·å‘æºç«™æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œè·å–æœ€æ–°çš„å†…å®¹ã€‚</li></ul></li><li><strong>å›æºä¸ç¼“å­˜ï¼š</strong>è¾¹ç¼˜èŠ‚ç‚¹ä»æºç«™è·å–åˆ°å†…å®¹åï¼Œä¸€æ–¹é¢å°†å…¶å‘é€ç»™ç”¨æˆ·ï¼Œå¦ä¸€æ–¹é¢ä¼šæŒ‰ç…§é¢„è®¾çš„ç¼“å­˜ç­–ç•¥ï¼ˆå¦‚ç¼“å­˜æ—¶é—´ã€ç¼“å­˜è§„åˆ™ç­‰ï¼‰å°†å†…å®¹å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä»¥ä¾¿åç»­æœ‰ç›¸åŒè¯·æ±‚æ—¶å¯ä»¥ç›´æ¥å“åº”ã€‚</li></ol><p>é€šè¿‡è¿™æ ·ä¸€å¥—å®Œæ•´ã€è‡ªåŠ¨åŒ–çš„æµç¨‹ï¼ŒCDNæˆåŠŸåœ°å°†ç”¨æˆ·è®¿é—®æµé‡åˆ†æ•£åˆ°äº†å„ä¸ªè¾¹ç¼˜èŠ‚ç‚¹ï¼Œæ—¢å‡è½»äº†æºç«™æœåŠ¡å™¨çš„å‹åŠ›ï¼Œåˆæ˜¾è‘—æå‡äº†ç»ˆç«¯ç”¨æˆ·çš„è®¿é—®é€Ÿåº¦å’Œä½“éªŒã€‚</p><h3 id="ä¼˜åŠ¿">3 ä¼˜åŠ¿</h3><p>å‡­å€Ÿå…¶ç‹¬ç‰¹çš„æŠ€æœ¯åŸç†ï¼ŒCDNè¢«å¹¿æ³›åº”ç”¨äºå„ç§äº’è”ç½‘ä¸šåŠ¡åœºæ™¯ï¼Œå…¶ä¸»è¦ä¼˜åŠ¿åŒ…æ‹¬ï¼š</p><ul><li><strong>åŠ é€Ÿç½‘ç«™è®¿é—®ï¼š</strong>æ˜¾è‘—å‡å°‘ç½‘é¡µåŠ è½½æ—¶é—´ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼Œé™ä½ç”¨æˆ·æµå¤±ç‡ã€‚</li><li><strong>åˆ†æ‹…æºç«™å‹åŠ›ï¼š</strong>å¤§éƒ¨åˆ†ç”¨æˆ·è¯·æ±‚ç”±CDNè¾¹ç¼˜èŠ‚ç‚¹å¤„ç†ï¼Œå¤§å¹…é™ä½æºç«™æœåŠ¡å™¨çš„è´Ÿè½½å’Œå¸¦å®½æ¶ˆè€—æˆæœ¬ã€‚</li><li><strong>æå‡å¯ç”¨æ€§ä¸å¯é æ€§ï¼š</strong>å•ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹çš„æ•…éšœä¸ä¼šå½±å“æ•´ä¸ªæœåŠ¡çš„å¯ç”¨æ€§ï¼ŒCDNçš„åˆ†å¸ƒå¼æ¶æ„æä¾›äº†å¤©ç„¶çš„å†—ä½™ã€‚</li><li><strong>å¢å¼ºå®‰å…¨æ€§ï¼š</strong>CDNå¯ä»¥éšè—æºç«™IPï¼Œå¹¶æä¾›DDoSæ”»å‡»é˜²æŠ¤ã€WAFï¼ˆWebåº”ç”¨é˜²ç«å¢™ï¼‰ç­‰å®‰å…¨åŠŸèƒ½ï¼Œä¿æŠ¤æºç«™å…å—ç½‘ç»œæ”»å‡»ã€‚</li><li><strong>æ”¯æŒå¤§è§„æ¨¡åˆ†å‘ï¼š</strong>å°¤å…¶é€‚ç”¨äºè§†é¢‘ç‚¹æ’­ã€ç›´æ’­ã€å¤§æ–‡ä»¶ä¸‹è½½ã€æ¸¸æˆåŠ é€Ÿç­‰éœ€è¦å¤„ç†æµ·é‡å¹¶å‘è¯·æ±‚å’Œé«˜å¸¦å®½æµé‡çš„åœºæ™¯ã€‚</li></ul><p>CDNå·²ç»æˆä¸ºç°ä»£äº’è”ç½‘ä¸å¯æˆ–ç¼ºçš„åŸºç¡€è®¾æ–½ï¼Œå®ƒé€šè¿‡æ™ºèƒ½çš„è°ƒåº¦å’Œåˆ†å¸ƒå¼çš„ç¼“å­˜ï¼Œæœ‰æ•ˆåœ°è§£å†³äº†å› åœ°ç†è·ç¦»å’Œç½‘ç»œæ‹¥å¡å¸¦æ¥çš„è®¿é—®å»¶è¿Ÿé—®é¢˜ï¼Œä¸ºå…¨çƒç”¨æˆ·æä¾›äº†æ›´å¿«é€Ÿã€æ›´å¯é ã€æ›´å®‰å…¨çš„ç½‘ç»œè®¿é—®ä½“éªŒã€‚</p><h3 id="ä½¿ç”¨">4 ä½¿ç”¨</h3><p>å¸¸è§çš„ CDN æœåŠ¡æœ‰ <strong>cdnjs</strong>ã€<strong>unpkg</strong> å’Œ<strong>jsDelivr</strong>ï¼Œå®ƒä»¬å„è‡ªæœ‰ä¸åŒçš„ç‰¹ç‚¹å’ŒåŠŸèƒ½ã€‚</p><ol type="1"><li>unpkgç±»å‹ï¼šåªæ”¯æŒ npm åŒ…ï¼Œnpm åŒ…åŠ é€Ÿ<ul><li>æä¾›æ–¹<ul><li>unpkgå®˜æ–¹: <code>https://unpkg.com</code></li></ul></li><li>ç¤ºä¾‹:<code>{url}/@{organization}/{package-name}@{version}/path/to/file</code></li></ul></li><li>jsdelivrç±»å‹ï¼šæ”¯æŒ npm åŒ… å’Œ GitHub ä»“åº“ï¼Œnpm åŒ… å’Œ GitHub ä»“åº“åŠ é€Ÿ<ul><li>æä¾›æ–¹<ul><li>jsdelivrå®˜æ–¹: <code>https://cdn.jsdelivr.net</code></li><li>fastly: <code>https://fastly.jsdelivr.net</code></li><li>cloudflare: <code>https://testingcf.jsdelivr.net</code></li><li>gcore: <code>gcore.jsdelivr.net</code></li></ul></li><li>npm:<code>{url}/npm/@{organization}/{package-name}@{version}/path/to/file</code></li><li>GitHub:<code>{url}/gh/{organization}/{repository}@{version}/path/to/file</code></li></ul></li><li>cdnjsç±»å‹ï¼šåªæ”¯æŒå·²åŠ å…¥çš„å¼€æºåº“ï¼ŒJavaScript/CSS åº“åŠ é€Ÿ<ul><li>åŸºç¡€URL: <code>https://cdnjs.cloudflare.com/ajax/libs/</code></li><li>ç¤ºä¾‹:<code>https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js</code></li></ul></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å†…å®¹åˆ†å‘ç½‘ç»œ-cdn&quot;&gt;å†…å®¹åˆ†å‘ç½‘ç»œ (CDN)&lt;/h2&gt;
&lt;p&gt;CDNï¼Œå…¨ç§° Content Delivery
Networkï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼‰ï¼Œæ˜¯ä¸€ç§é€šè¿‡åˆ†å¸ƒå¼éƒ¨ç½²çš„æœåŠ¡å™¨ç½‘ç»œæ¥åŠ é€Ÿå’Œä¼˜åŒ–å†…å®¹ä¼ è¾“çš„æŠ€æœ¯ã€‚å®ƒçš„æ ¸å¿ƒç›®æ ‡æ˜¯è®©ç”¨æˆ·èƒ½å¤Ÿå°±è¿‘è·å–æ‰€éœ€çš„ç½‘é¡µã€è§†é¢‘ã€å›¾ç‰‡ã€è„š</summary>
      
    
    
    
    <category term="éšç¬”" scheme="https://blog.keaikeqing.cn/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>git</title>
    <link href="https://blog.keaikeqing.cn/2025/02/25/TechnicalNotes/Git/"/>
    <id>https://blog.keaikeqing.cn/2025/02/25/TechnicalNotes/Git/</id>
    <published>2025-02-25T06:50:50.000Z</published>
    <updated>2025-03-19T06:50:50.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="gitignore">1. gitignore</h2><p><code>.gitignore</code> æ–‡ä»¶ç”¨äºæŒ‡å®šå“ªäº›æ–‡ä»¶æˆ–ç›®å½•åœ¨ Gitç‰ˆæœ¬æ§åˆ¶ä¸­è¢«å¿½ç•¥ã€‚å®ƒå¯ä»¥é¿å…å°†ä¸å¿…è¦çš„æ–‡ä»¶ï¼ˆå¦‚ç¼–è¯‘äº§ç‰©ã€ä¸´æ—¶æ–‡ä»¶ç­‰ï¼‰æäº¤åˆ°ç‰ˆæœ¬åº“ä¸­ã€‚</p><pre class="language-ignore" data-language="ignore"><code class="language-ignore"><span class="token comment"># å¿½ç•¥ç‰¹å®šæ–‡ä»¶</span><span class="token entry string">secret.txt</span><span class="token comment"># å¿½ç•¥ç‰¹å®šç›®å½•</span><span class="token entry string">temp<span class="token punctuation">/</span></span><span class="token comment"># å¿½ç•¥ç‰¹å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶(ä½†ä¿ç•™tempç›®å½•æœ¬èº«)</span><span class="token comment"># å¦‚æœ temp/ ç›®å½•æ˜¯ç©ºçš„ï¼ŒGit é»˜è®¤ä¸ä¼šè¿½è¸ªç©ºç›®å½•ï¼Œé€šå¸¸è¦ç”¨ .gitkeep ä¹‹ç±»çš„æ–‡ä»¶å¼ºåˆ¶ä¿ç•™</span><span class="token entry string">temp<span class="token punctuation">/</span><span class="token operator">*</span></span><span class="token comment"># å¿½ç•¥ç‰¹å®šç›®å½•ä¸‹çš„æ‰€æœ‰ .tmp æ–‡ä»¶</span><span class="token entry string">temp<span class="token punctuation">/</span><span class="token operator">*</span>.tmp</span><span class="token comment"># å¿½ç•¥ç‰¹å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ï¼Œä½†ä¿ç•™æŸä¸ªæ–‡ä»¶</span><span class="token entry string">temp<span class="token punctuation">/</span><span class="token operator">*</span></span><span class="token entry string"><span class="token operator">!</span>temp<span class="token punctuation">/</span>keep.txt</span><span class="token comment"># å¿½ç•¥ç‰¹å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ï¼Œä½†ä¿ç•™æŸä¸ªç›®å½•</span><span class="token entry string">temp<span class="token punctuation">/</span><span class="token operator">*</span></span><span class="token entry string"><span class="token operator">!</span>temp<span class="token punctuation">/</span>keep<span class="token punctuation">/</span></span></code></pre><h2 id="æ¸…é™¤å·²è·Ÿè¸ªçš„æ–‡ä»¶">2. æ¸…é™¤å·²è·Ÿè¸ªçš„æ–‡ä»¶</h2><p>ä¸ä¼šåˆ é™¤ Git æäº¤å†å²ä¸­çš„æ–‡ä»¶ï¼Œå®ƒ åªåˆ é™¤å·¥ä½œåŒºï¼ˆworkingdirectoryï¼‰å’Œæœªè·Ÿè¸ªçš„æ–‡ä»¶ï¼Œä¸ä¼šå½±å“ Git ç‰ˆæœ¬åº“çš„æäº¤è®°å½•:</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clean <span class="token parameter variable">-n</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-x</span>  <span class="token comment"># é¢„è§ˆå³å°†åˆ é™¤çš„æ–‡ä»¶</span><span class="token function">git</span> clean <span class="token parameter variable">-f</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-x</span>  <span class="token comment"># ç¡®è®¤æ— è¯¯åæ‰§è¡Œåˆ é™¤</span></code></pre><h2 id="å›é€€ä»¥å‰çš„æäº¤">3. å›é€€ä»¥å‰çš„æäº¤</h2><h3 id="reset-ç¡¬å›é€€">3.1 reset ç¡¬å›é€€</h3><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> reset <span class="token parameter variable">--hard</span> commit <span class="token function">id</span></code></pre><p>æ­¤æ—¶å†æ¨åˆ°è¿œç¨‹ä»“åº“ç”¨ <code>git push</code> ä¼šæŠ¥é”™ï¼Œéœ€è¦ç”¨<code>git push -f</code> å¼ºæ¨ä¸Šå»</p><h3 id="revert-è½¯å›é€€">3.2 revert è½¯å›é€€</h3><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> revert <span class="token parameter variable">-n</span> commit <span class="token function">id</span></code></pre><p>æ­¤æ—¶ä¼šåœ¨å½“å‰åˆ†æ”¯ä¸Šç”Ÿæˆä¸€ä¸ªæ–°çš„æäº¤ï¼Œå†…å®¹æ˜¯å°†æŒ‡å®šçš„æäº¤å›é€€åˆ°å½“å‰åˆ†æ”¯çš„çŠ¶æ€ã€‚æ³¨æ„ï¼š<code>-n</code>é€‰é¡¹è¡¨ç¤ºä¸ä¼šç«‹å³åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ï¼Œè€Œæ˜¯å°†å˜æ›´æ”¾å…¥æš‚å­˜åŒº</p><h2 id="æäº¤è§„èŒƒ">4. æäº¤è§„èŒƒ</h2><h3 id="æäº¤ä¿¡æ¯çš„åŸºæœ¬ç»“æ„">4.1 æäº¤ä¿¡æ¯çš„åŸºæœ¬ç»“æ„</h3><p>ä¸€ä¸ªæ ‡å‡†çš„ Git æäº¤ä¿¡æ¯é€šå¸¸åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š</p><pre class="language-none"><code class="language-none">&lt;ç±»å‹&gt;(&lt;èŒƒå›´&gt;): &lt;ç®€çŸ­æè¿°&gt;&lt;è¯¦ç»†æè¿°&gt;&lt;é¡µè„šæ³¨é‡Š&gt;</code></pre><ul><li><strong>ç±»å‹ (Type)</strong>ï¼šæè¿°æäº¤çš„ç±»åˆ«ï¼ŒæŒ‡æ˜æäº¤çš„æ€§è´¨ã€‚</li><li><strong>èŒƒå›´ (Scope)</strong>ï¼šæŒ‡å®šå˜æ›´çš„å…·ä½“æ¨¡å—ã€åŠŸèƒ½æˆ–æ–‡ä»¶ã€‚</li><li><strong>ç®€çŸ­æè¿°</strong>ï¼šå¯¹æœ¬æ¬¡æäº¤çš„ç®€è¦æ€»ç»“ã€‚</li><li><strong>è¯¦ç»†æè¿°</strong>ï¼ˆå¯é€‰ï¼‰ï¼šæä¾›æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œè§£é‡Šä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªæäº¤ã€å¦‚ä½•åšçš„ã€è§£å†³äº†ä»€ä¹ˆé—®é¢˜ç­‰ã€‚</li><li><strong>é¡µè„šæ³¨é‡Š</strong>ï¼ˆå¯é€‰ï¼‰ï¼šé“¾æ¥åˆ°é¡¹ç›®ç®¡ç†å·¥å…·ä¸­çš„ä»»åŠ¡ã€bugæˆ–æ•…äº‹ç­‰ã€‚</li></ul><h3 id="å¸¸è§çš„æäº¤ç±»å‹">4.2 <strong>å¸¸è§çš„æäº¤ç±»å‹</strong></h3><p>è¿™äº›ç±»å‹é€šå¸¸æ˜¯é‡‡ç”¨ <ahref="https://www.conventionalcommits.org/zh-hans">ConventionalCommits</a> æ ‡å‡†çš„å¸¸è§å€¼ï¼Œç›®çš„æ˜¯ä½¿æäº¤ä¿¡æ¯ä¸€è‡´ä¸”å…·æœ‰ç»“æ„åŒ–ã€‚</p><ol type="1"><li><code>fix</code>: ç±»å‹ ä¸º fix çš„æäº¤è¡¨ç¤ºåœ¨ä»£ç åº“ä¸­ä¿®å¤äº†ä¸€ä¸ªbugã€‚</li><li><code>feat</code>: ç±»å‹ ä¸º featçš„æäº¤è¡¨ç¤ºåœ¨ä»£ç åº“ä¸­æ–°å¢äº†ä¸€ä¸ªåŠŸèƒ½ã€‚</li><li><code>BREAKING CHANGE</code>: åœ¨è„šæ³¨ä¸­åŒ…å« BREAKING CHANGE: æˆ–<ç±»å‹>(èŒƒå›´) åé¢æœ‰ä¸€ä¸ª ! çš„æäº¤ï¼Œè¡¨ç¤ºå¼•å…¥äº†ç ´åæ€§ API å˜æ›´ã€‚ç ´åæ€§å˜æ›´å¯ä»¥æ˜¯ä»»æ„<em>ç±»å‹</em>æäº¤çš„ä¸€éƒ¨åˆ†ã€‚</li><li><code>build</code>:ç”¨äºä¿®æ”¹é¡¹ç›®æ„å»ºç³»ç»Ÿï¼Œä¾‹å¦‚ä¿®æ”¹ä¾èµ–åº“ã€å¤–éƒ¨æ¥å£æˆ–è€…å‡çº§ Nodeç‰ˆæœ¬ç­‰ï¼›</li><li><code>chore</code>:ç”¨äºå¯¹éä¸šåŠ¡æ€§ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œä¾‹å¦‚ä¿®æ”¹æ„å»ºæµç¨‹æˆ–è€…å·¥å…·é…ç½®ç­‰ï¼›</li><li><code>ci</code>: ç”¨äºä¿®æ”¹æŒç»­é›†æˆæµç¨‹ï¼Œä¾‹å¦‚ä¿®æ”¹ Travisã€Jenkinsç­‰å·¥ä½œæµé…ç½®ï¼›</li><li><code>docs</code>: ç”¨äºä¿®æ”¹æ–‡æ¡£ï¼Œä¾‹å¦‚ä¿®æ”¹ README æ–‡ä»¶ã€APIæ–‡æ¡£ç­‰ï¼›</li><li><code>style</code>:ç”¨äºä¿®æ”¹ä»£ç çš„æ ·å¼ï¼Œä¾‹å¦‚è°ƒæ•´ç¼©è¿›ã€ç©ºæ ¼ã€ç©ºè¡Œç­‰ï¼›</li><li><code>refactor</code>:ç”¨äºé‡æ„ä»£ç ï¼Œä¾‹å¦‚ä¿®æ”¹ä»£ç ç»“æ„ã€å˜é‡åã€å‡½æ•°åç­‰ä½†ä¸ä¿®æ”¹åŠŸèƒ½é€»è¾‘ï¼›</li><li><code>perf</code>:ç”¨äºä¼˜åŒ–æ€§èƒ½ï¼Œä¾‹å¦‚æå‡ä»£ç çš„æ€§èƒ½ã€å‡å°‘å†…å­˜å ç”¨ç­‰ï¼›</li><li><code>test</code>:ç”¨äºä¿®æ”¹æµ‹è¯•ç”¨ä¾‹ï¼Œä¾‹å¦‚æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ä»£ç çš„æµ‹è¯•ç”¨ä¾‹ç­‰ã€‚</li></ol><p>æ¯æ¬¡æäº¤åº”è¯¥åªåŒ…å«ä¸€ä¸ªé€»è¾‘å˜æ›´ï¼Œé¿å…æ··åˆå¤šä¸ªä¸ç›¸å…³çš„ä¿®æ”¹ã€‚</p><h2 id="gitå…¨å±€é…ç½®æ¨è">5. gitå…¨å±€é…ç½®æ¨è</h2><pre class="language-gitconfig" data-language="gitconfig"><code class="language-gitconfig">[user]    name &#x3D; xx    email &#x3D; xx@xx.com[http &quot;https:&#x2F;&#x2F;github.com&quot;]    proxy &#x3D; 127.0.0.1:7890       # GitHub ä»£ç†ï¼Œå¯æ ¹æ®å®é™…ç½‘ç»œç¯å¢ƒä¿®æ”¹[core]    autocrlf &#x3D; true              # è‡ªåŠ¨è½¬æ¢æ¢è¡Œç¬¦ï¼ŒWindows æ¨è trueï¼ŒmacOS&#x2F;Linux æ¨è input    quotepath &#x3D; false            # ä¸­æ–‡è·¯å¾„ä¸å†è½¬ä¹‰æ˜¾ç¤ºä¸º \uXXXX    editor &#x3D; code --wait         # é»˜è®¤ç¼–è¾‘å™¨ VSCodeï¼Œå¯æ”¹ä¸º notepad æˆ– vim    preloadindex &#x3D; true          # åŠ å¿« git status é€Ÿåº¦    fscache &#x3D; true               # Windows ä¸‹ç¼“å­˜æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ï¼Œæé«˜æ€§èƒ½    untrackedCache &#x3D; true        # åŠ é€Ÿæœªè·Ÿè¸ªæ–‡ä»¶æ£€æµ‹ï¼Œç‰¹åˆ«æ˜¯å¤§ä»“åº“[color]    ui &#x3D; auto                    # Git å‘½ä»¤è¾“å‡ºè‡ªåŠ¨å½©è‰²æ˜¾ç¤ºï¼ˆlogã€diff ç­‰ï¼‰[alias]    st &#x3D; status                  # git st â†’ git status    co &#x3D; checkout                # git co â†’ git checkout    br &#x3D; branch                  # git br â†’ git branch    ci &#x3D; commit                  # git ci â†’ git commit    df &#x3D; diff                     # git df â†’ git diff    lg &#x3D; log --graph --decorate --pretty&#x3D;format:&#39;%C(yellow)%h%Creset -%C(cyan)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&#39; --abbrev-commit --date&#x3D;relative                                  # ç¾è§‚çš„æäº¤å†å²ï¼Œå¸¦åˆ†æ”¯ã€æ ‡ç­¾ã€å›¾å½¢åŒ–æ˜¾ç¤º    last &#x3D; log -1 HEAD           # æŸ¥çœ‹æœ€åä¸€æ¬¡æäº¤    unstage &#x3D; reset HEAD --      # å–æ¶ˆæš‚å­˜åŒºæ–‡ä»¶    amend &#x3D; commit --amend --no-edit  # ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤ä½†ä¸æ›´æ”¹æäº¤ä¿¡æ¯[diff]    tool &#x3D; vscode    algorithm &#x3D; histogram        # æ›´æ™ºèƒ½çš„ diff ç®—æ³•ï¼Œå¤„ç†å¤§æ–‡ä»¶å’Œç§»åŠ¨ä»£ç å—æ›´å‡†ç¡®    colorMoved &#x3D; plain           # å¯ç”¨ç§»åŠ¨ä»£ç å—æ£€æµ‹ï¼Œæ˜¾ç¤ºæ›´ç›´è§‚    mnemonicPrefix &#x3D; true        # diff å‰ç¼€æ›´æ˜“ç†è§£    renames &#x3D; true               # è‡ªåŠ¨æ£€æµ‹æ–‡ä»¶é‡å‘½å    indentHeuristic &#x3D; true       # æ›´æ™ºèƒ½çš„ diff å—åˆ’åˆ†    compactionHeuristic &#x3D; true   # ä¼˜åŒ– diff è¾“å‡ºå¯è¯»æ€§[difftool &quot;vscode&quot;]    cmd &#x3D; code --wait --diff $LOCAL $REMOTE  # ä½¿ç”¨ VSCode ä½œä¸º diff å·¥å…·[merge]    tool &#x3D; vscode[mergetool &quot;vscode&quot;]    cmd &#x3D; code --wait $MERGED                 # ä½¿ç”¨ VSCode ä½œä¸º merge å·¥å…·[pull]    rebase &#x3D; false              # é¿å…é»˜è®¤ rebaseï¼Œå¯æ ¹æ®ä¸ªäººä¹ æƒ¯æ”¹ true[push]    default &#x3D; simple            # é¿å…æ¨é€åˆ°é”™è¯¯åˆ†æ”¯    autoSetupRemote &#x3D; true      # æ–°å»ºåˆ†æ”¯æ—¶è‡ªåŠ¨è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯    followTags &#x3D; true           # æ¨é€ commit æ—¶è‡ªåŠ¨æ¨é€å…³è”çš„ tag[init]    defaultBranch &#x3D; master      # åˆå§‹åŒ–ä»“åº“é»˜è®¤åˆ†æ”¯åï¼Œå¯æ”¹ä¸º main[column]    ui &#x3D; auto                   # åˆ—è¡¨å‘½ä»¤è‡ªåŠ¨å¯¹é½è¾“å‡º[branch]    sort &#x3D; -committerdate       # åˆ†æ”¯åˆ—è¡¨æŒ‰æœ€è¿‘æäº¤æ—¶é—´æ’åº[tag]    sort &#x3D; version:refname      # æ ‡ç­¾åˆ—è¡¨æŒ‰ç‰ˆæœ¬å·æ’åº[fetch]    prune &#x3D; true                # è‡ªåŠ¨åˆ é™¤è¿œç¨‹å·²åˆ é™¤çš„åˆ†æ”¯    pruneTags &#x3D; true            # è‡ªåŠ¨åˆ é™¤è¿œç¨‹å·²åˆ é™¤çš„æ ‡ç­¾    # fetch.all å¯é€‰ï¼Œæ ¹æ®é¡¹ç›®æ˜¯å¦å¤šè¿œç¨‹å†³å®šæ˜¯å¦å¼€å¯    # git config --global fetch.all true[help]    autocorrect &#x3D; prompt        # è¾“å…¥å‘½ä»¤æœ‰è¯¯æ—¶æç¤ºçº æ­£ï¼Œé¿å…è¯¯æ“ä½œ[commit]    verbose &#x3D; true              # æäº¤æ—¶æ˜¾ç¤º diff å†…å®¹ï¼Œæ–¹ä¾¿æ£€æŸ¥[rerere]    enabled &#x3D; true              # å¯ç”¨å†²çªé‡ç”¨åŠŸèƒ½    autoupdate &#x3D; true           # è‡ªåŠ¨åº”ç”¨å·²è§£å†³çš„å†²çª[rebase]    autoStash &#x3D; true            # rebase å‰è‡ªåŠ¨ stashï¼Œå®Œæˆåè‡ªåŠ¨ pop    autoSquash &#x3D; true           # è‡ªåŠ¨å¤„ç† fixup!&#x2F;squash! æäº¤    missingCommitsCheck &#x3D; warn  # ä¸¢å¤±æäº¤æ—¶è­¦å‘Š[stash]    showPatch &#x3D; true            # stash show é»˜è®¤æ˜¾ç¤º diff[status]    submoduleSummary &#x3D; true     # æ˜¾ç¤ºå­æ¨¡å—å˜æ›´æ‘˜è¦    showStash &#x3D; true            # æ˜¾ç¤º stash æ•°é‡    aheadBehind &#x3D; true          # æ˜¾ç¤ºåˆ†æ”¯é¢†å…ˆ&#x2F;è½åä¿¡æ¯[index]    threads &#x3D; true              # å¤šçº¿ç¨‹åŠ é€Ÿç´¢å¼•æ“ä½œ</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;gitignore&quot;&gt;1. gitignore&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;.gitignore&lt;/code&gt; æ–‡ä»¶ç”¨äºæŒ‡å®šå“ªäº›æ–‡ä»¶æˆ–ç›®å½•åœ¨ Git
ç‰ˆæœ¬æ§åˆ¶ä¸­è¢«å¿½ç•¥ã€‚å®ƒå¯ä»¥é¿å…å°†ä¸å¿…è¦çš„æ–‡ä»¶ï¼ˆå¦‚ç¼–è¯‘äº§ç‰©ã€ä¸´æ—¶æ–‡ä»¶ç­‰ï¼‰æäº¤åˆ°ç‰ˆæœ¬åº“ä¸­ã€‚&lt;/p&gt;
&lt;pre class</summary>
      
    
    
    
    <category term="éšç¬”" scheme="https://blog.keaikeqing.cn/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>Live2D Widgetä½¿ç”¨è¯´æ˜</title>
    <link href="https://blog.keaikeqing.cn/2024/11/20/TechnicalNotes/live2d/"/>
    <id>https://blog.keaikeqing.cn/2024/11/20/TechnicalNotes/live2d/</id>
    <published>2024-11-20T04:50:50.000Z</published>
    <updated>2025-03-19T06:50:50.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="live2d-widget-ä½¿ç”¨è¯´æ˜">Live2D Widget ä½¿ç”¨è¯´æ˜</h1><p>åœ¨ç½‘é¡µä¸­æ·»åŠ  Live2D çœ‹æ¿å¨˜ã€‚å…¼å®¹ PJAXï¼Œæ”¯æŒæ— åˆ·æ–°åŠ è½½ã€‚(æ³¨ï¼šå·²ä¸å†éœ€è¦é…ç½®ä¾èµ– jQuery å’Œ Font Awesome)</p><p>ä»£ç ï¼š <ahref="https://github.com/stevenjoezhang/live2d-widget">live2d-widget</a><a href="https://github.com/fghrsh/live2d_api">live2d_api</a></p><p>åšæ–‡ï¼š<br /><a href="https://www.fghrsh.net/post/123.html">ç½‘é¡µæ·»åŠ  Live2Dçœ‹æ¿å¨˜</a> <a href="https://www.fghrsh.net/post/170.html">Live2D çœ‹æ¿å¨˜API è¿ç§»å…¬å‘Š</a></p><h2 id="ç®€å•é…ç½®">1 ç®€å•é…ç½®</h2><p>åªéœ€è¦æœ€åŸºç¡€çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆåªç”¨å°†è¿™ä¸€è¡Œä»£ç åŠ å…¥ html é¡µé¢çš„<code>head</code> æˆ– <code>body</code> ä¸­ï¼Œå³å¯åŠ è½½çœ‹æ¿å¨˜ï¼š</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><ol type="1"><li>æ·»åŠ ä»£ç çš„ä½ç½®å–å†³äºä½ çš„ç½‘ç«™çš„æ„å»ºæ–¹å¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ <ahref="https://hexo.io">Hexo</a>ï¼Œé‚£ä¹ˆéœ€è¦åœ¨ä¸»é¢˜çš„æ¨¡ç‰ˆæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸Šä»£ç ã€‚å¯¹äºç”¨å„ç§æ¨¡ç‰ˆå¼•æ“ç”Ÿæˆçš„é¡µé¢ï¼Œä¿®æ”¹æ–¹æ³•ç±»ä¼¼ã€‚<br /></li><li>å¦‚æœç½‘ç«™å¯ç”¨äº† PJAXï¼Œç”±äºçœ‹æ¿å¨˜ä¸å¿…æ¯é¡µåˆ·æ–°ï¼Œéœ€è¦æ³¨æ„å°†è¯¥è„šæœ¬æ”¾åˆ°PJAX åˆ·æ–°åŒºåŸŸä¹‹å¤–ã€‚</li></ol><h2 id="è¿›é˜¶é…ç½®">2 è¿›é˜¶é…ç½®</h2><h3 id="ä¿®æ”¹autoload.jsæ–‡ä»¶">2.1 ä¿®æ”¹<code>autoload.js</code>æ–‡ä»¶</h3><p>ä¸‹è½½<ahref="https://github.com/stevenjoezhang/live2d-widget">live2d-widget</a>æºç ï¼Œæ‰¾åˆ°å…¶ä¸­çš„<code>autoload.js</code>æ–‡ä»¶ï¼Œä¿®æ”¹å…¶ä¸­çš„é…ç½®é¡¹ã€‚</p><p><code>autoload.js</code>ä¼šè‡ªåŠ¨åŠ è½½ä¸‰ä¸ªæ–‡ä»¶ï¼š<code>waifu.css</code>ï¼Œ<code>live2d.min.js</code>å’Œ <code>waifu-tips.js</code>ã€‚<code>waifu-tips.js</code> ä¼šåˆ›å»º<code>initWidget</code>å‡½æ•°ï¼Œè¿™å°±æ˜¯åŠ è½½çœ‹æ¿å¨˜çš„ä¸»å‡½æ•°ã€‚<code>initWidget</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ªObject ç±»å‹çš„å‚æ•°ï¼Œä½œä¸ºçœ‹æ¿å¨˜çš„é…ç½®ã€‚ä»¥ä¸‹æ˜¯é…ç½®é€‰é¡¹ï¼š</p><table><colgroup><col style="width: 25%" /><col style="width: 25%" /><col style="width: 25%" /><col style="width: 25%" /></colgroup><thead><tr><th>é€‰é¡¹</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>live2d_path</code></td><td><code>string</code></td><td><code>https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/</code></td><td>live2d-widget è·¯å¾„ï¼Œè·¯å¾„æœ«å°¾çš„ <code>/</code> ä¸€å®šè¦åŠ ä¸Š</td></tr><tr><td><code>apiPath</code></td><td><code>string</code></td><td><code>https://live2d.fghrsh.net/api/</code></td><td>API è·¯å¾„ï¼Œè·¯å¾„æœ«å°¾çš„ <code>/</code> ä¸€å®šè¦åŠ ä¸Š</td></tr><tr><td><code>cdnPath</code></td><td><code>string</code></td><td><code>https://fastly.jsdelivr.net/gh/fghrsh/live2d_api@latest/</code></td><td>CDN è·¯å¾„ï¼Œè·¯å¾„æœ«å°¾çš„ <code>/</code> ä¸€å®šè¦åŠ ä¸Š</td></tr><tr><td><code>tools</code></td><td><code>string[]</code></td><td>è§ <code>autoload.js</code></td><td>åŠ è½½çš„å°å·¥å…·æŒ‰é’®ï¼Œå¯é€‰å‚æ•°</td></tr></tbody></table><p>1ï¸âƒ£ <code>live2d_path</code> æ˜¯ live2d-widgetçš„èµ„æºè·¯å¾„ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹ã€‚</p><p>ä¸‹è½½<ahref="https://github.com/stevenjoezhang/live2d-widget">live2d-widget</a></p><ol type="1"><li>æœ¬åœ°å­˜æ”¾ï¼šå°†ä¸‹è½½çš„ä»“åº“æ”¾åœ¨æœ¬åœ°ç›®å½•ä¸‹ï¼ŒæŒ‡å‘æœ¬åœ°è·¯å¾„ï¼Œä¾‹å¦‚<code>/assets/live2d-widget/</code>ã€‚å¦‚hexoï¼Œæ”¾åœ¨åšå®¢æºæ–‡ä»¶ç›®å½•ä¸‹ï¼ˆ<code>source</code> ç›®å½•ï¼‰ï¼Œéœ€è¦è®¾ç½® <code>skip_render</code>ã€‚</li><li>äº‘ç«¯å­˜æ”¾ï¼šå°†ä¸‹è½½çš„ä»“åº“ä¸Šä¼ åˆ°äº‘ç«¯ï¼ŒæŒ‡å‘äº‘ç«¯è·¯å¾„<ul><li>githubï¼šä½¿ç”¨ <code>jsdelivr</code>ï¼Œä¾‹å¦‚<code>https://cdn.jsdelivr.net/gh/username/live2d-widget@latest/</code>ï¼Œéœ€è¦åˆ›å»ºæ–°çš„git tag å¹¶æ¨é€è‡³ GitHub ä»“åº“ä¸­ï¼Œå¦åˆ™æ­¤å¤„çš„ <code>@latest</code>ä»ç„¶æŒ‡å‘æ›´æ–°å‰çš„æ–‡ä»¶ã€‚</li><li>npmï¼šä½¿ç”¨ <code>unpkg</code>æˆ–è€…<code>jsdelivr</code>ï¼Œä¾‹å¦‚<code>https://unpkg.com/[package_name]/@latest/</code> æˆ–<code>https://cdn.jsdelivr.net/npm/[package_name]/@latest/</code></li><li>äº‘æœåŠ¡å™¨: æ–°å»º<strong>é™æ€</strong>é¡¹ç›®ï¼Œä¾‹å¦‚<code>https://example.com/path/to/live2d-widget/</code></li></ul></li></ol><p>2ï¸âƒ£ <code>apiPath</code> å’Œ <code>cdnPath</code>ä¸¤ä¸ªå‚æ•°è®¾ç½®å…¶ä¸­ä¸€é¡¹å³å¯ã€‚</p><p>ä¸‹è½½<a href="https://github.com/fghrsh/live2d_api">live2d_api</a></p><ul><li><code>apiPath</code> æ˜¯åç«¯ API çš„ URLï¼Œå¯ä»¥è‡ªè¡Œæ­å»ºï¼Œå¹¶å¢åŠ æ¨¡å‹ã€‚<ul><li>éœ€è¦æ”¯æŒ <code>GET</code> è¯·æ±‚ï¼Œå› æ­¤éœ€è¦å»ºç«™ï¼Œä»¥å®å¡”é¢æ¿ä¸ºä¾‹ï¼š<ul><li>é¦–å…ˆï¼Œåœ¨å®å¡”é¢æ¿åˆ›å»ºæ–°ç«™ç‚¹ï¼Œè®¾ç½®å¥½ PHP ç‰ˆæœ¬ï¼ˆä¸æ˜¯çº¯é™æ€ï¼‰ï¼Œå¹¶æ·»åŠ ä¸ŠSSL è¯ä¹¦ã€‚</li><li>ç„¶åï¼Œåˆ å»ç½‘ç«™æ ¹ç›®å½• /www/wwwroot/api/ä¸‹é»˜è®¤æ·»åŠ åˆ›å»ºçš„æ‰€æœ‰æ–‡ä»¶ã€‚</li><li>æ‰“å¼€ SSH ç»ˆç«¯ï¼ŒæŠŠ Live2D API æºä»£ç æ”¾åˆ°ç½‘ç«™ live2d/ ç›®å½•</li></ul></li></ul></li><li><code>cdnPath</code> åˆ™æ˜¯ç±»ä¼¼äº <code>live2d_path</code>çš„è·¯å¾„ï¼Œç”¨äºåŠ è½½æ¨¡å‹æ–‡ä»¶ã€‚<ul><li>æœ¬åœ°å­˜æ”¾å’Œäº‘ç«¯å­˜æ”¾åŒä¸Šã€‚</li></ul></li></ul><h3 id="æ·»åŠ autoload.jsæ–‡ä»¶">2.2 æ·»åŠ <code>autoload.js</code>æ–‡ä»¶</h3><p>ä¿®æ”¹<code>live2d_path</code>åå°†è¿™ä¸€è¡Œä»£ç åŠ å…¥ html é¡µé¢çš„<code>head</code> æˆ– <code>body</code> ä¸­ï¼Œå³å¯åŠ è½½çœ‹æ¿å¨˜ï¼š</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;live2d_path&#125;/autoload.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><h3 id="æµ‹è¯•">2.3 æµ‹è¯•</h3><p>ä¸å¦¨è¯•è¯•èƒ½å¦æ­£å¸¸åœ°é€šè¿‡æµè§ˆå™¨æ‰“å¼€ <code>autoload.js</code> å’Œ<code>live2d.min.js</code>ç­‰æ–‡ä»¶ï¼Œå¹¶ç¡®è®¤è¿™äº›æ–‡ä»¶çš„å†…å®¹æ˜¯å®Œæ•´å’Œæ­£ç¡®çš„ã€‚</p><h2 id="é«˜çº§é…ç½®">3 é«˜çº§é…ç½®</h2><p>ä¿®æ”¹æ ·å¼å’Œæ¨¡å‹ï¼šè‡ªè¡ŒæŸ¥é˜…ä¸¤ä¸ªä»“åº“çš„README.mdæ–‡ä»¶å’Œæºç ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;live2d-widget-ä½¿ç”¨è¯´æ˜&quot;&gt;Live2D Widget ä½¿ç”¨è¯´æ˜&lt;/h1&gt;
&lt;p&gt;åœ¨ç½‘é¡µä¸­æ·»åŠ  Live2D çœ‹æ¿å¨˜ã€‚å…¼å®¹ PJAXï¼Œæ”¯æŒæ— åˆ·æ–°åŠ è½½ã€‚
(æ³¨ï¼šå·²ä¸å†éœ€è¦é…ç½®ä¾èµ– jQuery å’Œ Font Awesome)&lt;/p&gt;
&lt;p&gt;ä»£ç ï¼š &lt;a
</summary>
      
    
    
    
    <category term="éšç¬”" scheme="https://blog.keaikeqing.cn/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>Twikooè¯„è®ºç³»ç»Ÿé…ç½®</title>
    <link href="https://blog.keaikeqing.cn/2024/11/20/Web/Twikoo/"/>
    <id>https://blog.keaikeqing.cn/2024/11/20/Web/Twikoo/</id>
    <published>2024-11-20T02:00:00.000Z</published>
    <updated>2025-09-23T07:17:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="twikoo-è¯„è®ºç³»ç»Ÿé…ç½®">Twikoo è¯„è®ºç³»ç»Ÿé…ç½®</h1><p>ç›®å‰å¾ˆå¤šé¢æ¿æ”¯æŒä¸€é”®é…ç½®ï¼Œä»¥ä¸‹æ˜¯ç§æœ‰éƒ¨ç½²æ–¹å¼ä»‹ç»</p><h2 id="äº‘ç«¯éƒ¨ç½²">äº‘ç«¯éƒ¨ç½²</h2><ol type="1"><li>åœ¨ <a href="https://twikoo.js.org/">TwiKoo å®˜ç½‘</a>æ‰¾åˆ°äº‘å‡½æ•°éƒ¨ç½²çš„ç§æœ‰éƒ¨ç½²æ–¹å¼ï¼ŒæŒ‰ç…§æ–‡æ¡£è¿›è¡Œé…ç½®ã€‚</li><li><a href="https://nodejs.org/zh-cn/download">ä¸‹è½½nodejs</a>é€‰æ‹©æœ€æ–°çš„LTSç‰ˆæœ¬ï¼ŒLinuxï¼Œnvmï¼Œnpmã€‚æŒ‰ç…§å‘½ä»¤å®‰è£…ã€‚</li><li>æŒ‡å®šé•œåƒæºï¼š<code>npm config set registry https://registry.npmmirror.com</code></li><li>å®‰è£… Twikoo server:<code>npm i -g tkserver</code>æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š<code>npm ls tkserver -g</code></li><li>é…ç½®ç¯å¢ƒå˜é‡ï¼Œä¸»è¦å…³æ³¨ä»¥ä¸‹å‡ ä¸ªå‚æ•°ï¼š<ul><li><code>TWIKOO_DATA</code>ï¼šlokijs æ•°æ®åº“å­˜å‚¨è·¯å¾„ï¼Œé»˜è®¤æ˜¯<code>./data</code>ã€‚</li><li><code>TWIKOO_PORT</code>ï¼šæœåŠ¡ç«¯å£ï¼Œé»˜è®¤æ˜¯ <code>8080</code></li><li><code>TWIKOO_IP_HEADERS</code>ï¼šåœ¨ç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨ï¼Œå¦‚ä½¿ç”¨äº†CloudFlare CDN å®ƒä¼šå°†è¯·æ±‚ IP å†™åˆ°è¯·æ±‚å¤´çš„ cf-connecting-ipå­—æ®µä¸Šï¼Œä¸ºäº†èƒ½å¤Ÿæ­£ç¡®çš„è·å–è¯·æ±‚ IP ä½ å¯ä»¥å†™æˆ[â€œheaders.cf-connecting-ipâ€]ï¼Œé»˜è®¤æ˜¯ []</li></ul></li><li>å¯åŠ¨æœåŠ¡<ul><li>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚<code>/www/wwwroot/twikoo</code>ï¼Œ<strong>åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹</strong>æ‰§è¡Œå¯åŠ¨å‘½ä»¤å³å¯å°†æ•°æ®åº“æ–‡ä»¶å­˜å‚¨åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹</li><li><code>export TWIKOO_DATA=/www/wwwroot/twikoo/data</code></li><li><code>export TWIKOO_PORT=xxxx</code></li><li><code>export TWIKOO_IP_HEADERS=["headers.cf-connecting-ip"]</code></li><li><code>source ~/.bashrc</code></li><li>æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦è®¾ç½®æˆåŠŸ(æ³¨æ„ï¼šæœ‰æ—¶è®¾ç½®ä¸æˆåŠŸï¼Œå¯ä»¥ç›´æ¥æ·»åŠ åˆ°/root/.bashrcä¸­)ï¼š<ul><li><code>export | grep TWIKOO</code></li><li>ç²—ç•¥å¯åŠ¨æœåŠ¡<code>tkserver</code>å¹¶è®¿é—®<code>http://ip:xxxx</code>æŸ¥çœ‹æ˜¯å¦æˆåŠŸï¼ˆ<strong>æ³¨1</strong>ï¼‰</li></ul></li></ul></li><li>åœ¨<strong>æ–°æ–‡ä»¶å¤¹</strong>ä¸‹<code>nohup tkserver &gt;&gt; tkserver.log 2&gt;&amp;1 &amp;</code>å‘½ä»¤åå°å¯åŠ¨ï¼Œè®¿é—®<a href="http://æœåŠ¡ç«¯IP:ç«¯å£å·" class="uri">http://æœåŠ¡ç«¯IP:ç«¯å£å·</a>æµ‹è¯•æœåŠ¡æ˜¯å¦å¯åŠ¨æˆåŠŸã€‚ä½†æ˜¯æ¦‚ç‡å­˜åœ¨ä½¿ç”¨<code>nohup &amp;</code>å‘½ä»¤è¿è¡Œshellè„šæœ¬ï¼Œå…³é—­ç»ˆç«¯ä»ç„¶é€€å‡º(å¯ä»¥è¯•è¯•exitå‘½ä»¤æ³¨é”€ç»ˆç«¯)â€¦â€¦</li><li>é…ç½®ä»£ç†å®ç° HTTPS è®¿é—®:<ul><li>æ·»åŠ çº¯é™æ€ç«™ç‚¹ï¼šPHPé¡¹ç›®ï¼Œtwikoo.{åŸŸå}</li><li>é…ç½®sslè¯ä¹¦:letâ€™s encrypt æ‰‹åŠ¨è§£æ é€šé…ç¬¦ä¿®æ”¹å¯¹åº”çš„é˜¿é‡Œäº‘å’Œcloudflareçš„DNSè§£æï¼Œä¹Ÿå¯èƒ½åªéœ€è¦ä¿®æ”¹cloudflareçš„DNSè§£æ</li><li>æ·»åŠ åå‘ä»£ç†: ä»£ç†åç§°ï¼štwikooï¼Œç›®æ ‡URLï¼š<ahref="http://127.0.0.1:%7Bç«¯å£%7D"class="uri">http://127.0.0.1:{ç«¯å£}</a>ï¼Œä»£ç†åŸŸåï¼š$host</li></ul></li><li>æœ€ç»ˆè®¿é—®åœ°å€ä¸ºï¼š<a href="https://twikoo.%7BåŸŸå%7D"class="uri">https://twikoo.{åŸŸå}</a></li><li>æ³¨æ„å®šæœŸå¤‡ä»½æ•°æ®åº“æ–‡ä»¶ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±</li></ol><h2 id="å‰ç«¯é…ç½®">å‰ç«¯é…ç½®</h2><p>åˆ°åšå®¢é…ç½®æ–‡ä»¶ä¸­é…ç½® envId ä¸º https:// åŠ åŸŸåï¼ˆä¾‹å¦‚ <ahref="https://twikoo.yourdomain.comï¼‰"class="uri">https://twikoo.yourdomain.comï¼‰</a></p><h2 id="æ›´æ–°äº‘ç«¯">æ›´æ–°äº‘ç«¯</h2><ol type="1"><li>åœæ­¢æ—§ç‰ˆæœ¬<code>kill $(ps -ef | grep tkserver | grep -v 'grep' | awk '{print $2}')</code></li><li>æ‹‰å–æ–°ç‰ˆæœ¬ <code>npm i -g tkserver@latest</code></li><li>å›åˆ°ä¸Šæ–‡ç¬¬7æ­¥é‡æ–°å¯åŠ¨æœåŠ¡</li></ol><p>æ³¨1ï¼šå‰ææ˜¯éœ€è¦åœ¨<strong>æœåŠ¡å™¨å®‰å…¨ç»„</strong>å’Œ<strong>å®å¡”é¢æ¿</strong>ä¸­å¼€æ”¾è¯¥ç«¯å£ï¼Œç”¨å®Œ<strong>å…³é—­</strong>è¿™ä¸¤ä¸ªç«¯å£ã€‚æˆ–è€…å…ˆé…ç½®åå‘ä»£ç†ï¼Œç›´æ¥è®¿é—®åŸŸåã€‚å°±ä¸éœ€è¦å¼€æ”¾ç«¯å£äº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;twikoo-è¯„è®ºç³»ç»Ÿé…ç½®&quot;&gt;Twikoo è¯„è®ºç³»ç»Ÿé…ç½®&lt;/h1&gt;
&lt;p&gt;ç›®å‰å¾ˆå¤šé¢æ¿æ”¯æŒä¸€é”®é…ç½®ï¼Œä»¥ä¸‹æ˜¯ç§æœ‰éƒ¨ç½²æ–¹å¼ä»‹ç»&lt;/p&gt;
&lt;h2 id=&quot;äº‘ç«¯éƒ¨ç½²&quot;&gt;äº‘ç«¯éƒ¨ç½²&lt;/h2&gt;
&lt;ol type=&quot;1&quot;&gt;
&lt;li&gt;åœ¨ &lt;a href=&quot;https://twiko</summary>
      
    
    
    
    <category term="ç½‘ç«™æ­å»º" scheme="https://blog.keaikeqing.cn/categories/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>å¼ºåŒ–å­¦ä¹ â€”â€” A åŸºäºå€¼å‡½æ•°vsåŸºäºç­–ç•¥æ–¹æ³•</title>
    <link href="https://blog.keaikeqing.cn/2024/09/19/RL/A%20%E5%9F%BA%E4%BA%8E%E5%80%BC%E5%87%BD%E6%95%B0vs%E5%9F%BA%E4%BA%8E%E7%AD%96%E7%95%A5%E6%96%B9%E6%B3%95/"/>
    <id>https://blog.keaikeqing.cn/2024/09/19/RL/A%20%E5%9F%BA%E4%BA%8E%E5%80%BC%E5%87%BD%E6%95%B0vs%E5%9F%BA%E4%BA%8E%E7%AD%96%E7%95%A5%E6%96%B9%E6%B3%95/</id>
    <published>2024-09-19T01:40:43.000Z</published>
    <updated>2025-05-29T01:40:43.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŸºäºå€¼å‡½æ•°-vs-åŸºäºç­–ç•¥æ–¹æ³•">1. åŸºäºå€¼å‡½æ•° vs åŸºäºç­–ç•¥æ–¹æ³•</h2><p>å¼ºåŒ–å­¦ä¹ è§£å†³å†³ç­–é—®é¢˜çš„æ€è·¯å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šä¸€ç±»æ˜¯â€è¯„ä¼°ä»·å€¼åå†³ç­–â€ï¼Œå¦ä¸€ç±»æ˜¯â€ç›´æ¥ä¼˜åŒ–å†³ç­–â€ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„<strong>åŸºäºå€¼å‡½æ•°çš„æ–¹æ³•</strong>å’Œ<strong>åŸºäºç­–ç•¥çš„æ–¹æ³•</strong>ã€‚</p><h3 id="åŸºäºå€¼å‡½æ•°çš„æ–¹æ³•å…ˆè¯„ä¼°å†å†³ç­–">1.1åŸºäºå€¼å‡½æ•°çš„æ–¹æ³•ï¼šå…ˆè¯„ä¼°ï¼Œå†å†³ç­–</h3><p>æƒ³è±¡ä½ æ˜¯ä¸€ä¸ªä¸‹æ£‹çš„æ–°æ‰‹ï¼Œå¦‚ä½•æé«˜æ£‹è‰ºï¼Ÿä¸€ä¸ªç›´è§‚çš„æƒ³æ³•æ˜¯ï¼šå­¦ä¼šè¯„ä¼°æ¯ä¸ªå±€é¢çš„å¥½åï¼Œç„¶åé€‰æ‹©èƒ½è¾¾åˆ°æœ€å¥½å±€é¢çš„èµ°æ³•ã€‚è¿™å°±æ˜¯åŸºäºå€¼å‡½æ•°æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³ã€‚</p><h4 id="æ ¸å¿ƒç†å¿µ">æ ¸å¿ƒç†å¿µ</h4><p>åŸºäºå€¼å‡½æ•°çš„æ–¹æ³•é€šè¿‡å­¦ä¹ <strong>ä»·å€¼è¯„ä¼°å‡½æ•°</strong>æ¥æŒ‡å¯¼å†³ç­–ï¼š</p><ul><li><strong>å€¼å‡½æ•°è¯„ä¼°</strong>ï¼šåŸºäºå€¼å‡½æ•°çš„æ–¹æ³•ä¸»è¦é€šè¿‡ä¼°è®¡çŠ¶æ€å€¼å‡½æ•°( V(s) ) æˆ–åŠ¨ä½œä»·å€¼å‡½æ•° ( Q(s, a) )æ¥è¯„ä¼°æ¯ä¸ªçŠ¶æ€æˆ–çŠ¶æ€-åŠ¨ä½œå¯¹çš„ä¼˜åŠ£ã€‚è¿™é‡Œï¼Œ( V(s) ) è¡¨ç¤ºåœ¨çŠ¶æ€ ( s )ä¸‹èƒ½è·å¾—çš„æœŸæœ›ç´¯è®¡å¥–åŠ±ï¼Œè€Œ ( Q(s, a) ) åˆ™è¡¨ç¤ºåœ¨çŠ¶æ€ ( s ) é‡‡å–åŠ¨ä½œ ( a )åçš„æœŸæœ›ç´¯è®¡å¥–åŠ±ã€‚</li><li><strong>ç­–ç•¥é—´æ¥å¯¼å‡º</strong>ï¼šè¿™äº›æ–¹æ³•é€šå¸¸ä¸ç›´æ¥è¡¨ç¤ºç­–ç•¥ï¼Œè€Œæ˜¯é€šè¿‡ä¼˜åŒ–å€¼å‡½æ•°ï¼Œç„¶åä»ä¸­æ¨å¯¼å‡ºæœ€ä¼˜ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œåœ¨ç»™å®š( Q(s, a) ) çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡é€‰æ‹©ä½¿ ( Q(s, a) )æœ€å¤§çš„åŠ¨ä½œæ¥è·å¾—æœ€ä¼˜ç­–ç•¥ã€‚</li><li><strong>çŠ¶æ€ä»·å€¼å‡½æ•°</strong> <spanclass="math inline">\(V(s)\)</span>ï¼šè¯„ä¼°â€åœ¨çŠ¶æ€sä¸‹ï¼ŒæŒ‰ç…§å½“å‰ç­–ç•¥èƒ½è·å¾—å¤šå°‘é•¿æœŸå¥–åŠ±â€</li><li><strong>åŠ¨ä½œä»·å€¼å‡½æ•°</strong> <spanclass="math inline">\(Q(s,a)\)</span>ï¼šè¯„ä¼°â€åœ¨çŠ¶æ€sä¸‹é‡‡å–åŠ¨ä½œaï¼Œèƒ½è·å¾—å¤šå°‘é•¿æœŸå¥–åŠ±â€</li></ul><p>æœ‰äº†è¿™äº›ä»·å€¼è¯„ä¼°ï¼Œç­–ç•¥å°±æ°´åˆ°æ¸ æˆäº†â€”â€”æ€»æ˜¯é€‰æ‹©ä»·å€¼æœ€é«˜çš„åŠ¨ä½œã€‚</p><h4 id="å…¸å‹ç®—æ³•">å…¸å‹ç®—æ³•</h4><p><strong>Qå­¦ä¹ (Q-Learning)</strong>ï¼šæœ€ç»å…¸çš„å€¼å‡½æ•°æ–¹æ³•</p><ul><li>ç›´æ¥å­¦ä¹ æœ€ä¼˜åŠ¨ä½œä»·å€¼å‡½æ•° <spanclass="math inline">\(Q^*(s,a)\)</span></li><li>é‡‡ç”¨â€æ—¶é—´å·®åˆ†â€çš„æ€æƒ³é€æ­¥æ”¹è¿›Qå€¼ä¼°è®¡</li><li>å±äºoff-policyç®—æ³•ï¼Œå¯ä»¥ä»ä»»æ„è¡Œä¸ºç­–ç•¥ä¸­å­¦ä¹ </li></ul><p><strong>æ·±åº¦Qç½‘ç»œ(DQN)</strong>ï¼šQå­¦ä¹ çš„æ·±åº¦å­¦ä¹ ç‰ˆæœ¬</p><ul><li>ç”¨ç¥ç»ç½‘ç»œè¿‘ä¼¼Qå‡½æ•°ï¼Œå¤„ç†é«˜ç»´çŠ¶æ€ç©ºé—´</li><li>å¼•å…¥ç»éªŒå›æ”¾å’Œç›®æ ‡ç½‘ç»œç­‰æŠ€å·§æé«˜ç¨³å®šæ€§</li></ul><h3 id="åŸºäºç­–ç•¥çš„æ–¹æ³•ç›´æ¥ä¼˜åŒ–å†³ç­–">1.2åŸºäºç­–ç•¥çš„æ–¹æ³•ï¼šç›´æ¥ä¼˜åŒ–å†³ç­–</h3><p>å¦‚æœè¯´å€¼å‡½æ•°æ–¹æ³•æ˜¯â€ä¸‰æ€è€Œåè¡Œâ€ï¼Œé‚£ä¹ˆç­–ç•¥æ–¹æ³•å°±æ˜¯â€ç†Ÿèƒ½ç”Ÿå·§â€â€”â€”ç›´æ¥ç»ƒä¹ å†³ç­–è¿‡ç¨‹æœ¬èº«ï¼Œé€šè¿‡ä¸æ–­è¯•é”™æ¥æ”¹è¿›ç­–ç•¥ã€‚</p><h4 id="æ ¸å¿ƒç†å¿µ-1">æ ¸å¿ƒç†å¿µ</h4><p>åŸºäºç­–ç•¥çš„æ–¹æ³•å°†ç­–ç•¥å‚æ•°åŒ–ä¸º <spanclass="math inline">\(\pi_\theta(a|s)\)</span>ï¼Œç›´æ¥ä¼˜åŒ–ç­–ç•¥å‚æ•° <spanclass="math inline">\(\theta\)</span>ï¼š</p><ul><li><strong>ç›®æ ‡æ˜ç¡®</strong>ï¼šæœ€å¤§åŒ–æœŸæœ›ç´¯ç§¯å¥–åŠ± <spanclass="math inline">\(J(\theta) = \mathbb{E}_{\tau \sim\pi_\theta}[R(\tau)]\)</span></li><li><strong>æ¢¯åº¦ä¸Šå‡</strong>ï¼šåˆ©ç”¨ç­–ç•¥æ¢¯åº¦å®šç†è®¡ç®—å‚æ•°æ›´æ–°æ–¹å‘</li><li><strong>è‡ªç„¶æ¢ç´¢</strong>ï¼šéšæœºç­–ç•¥å¤©ç„¶å…·å¤‡æ¢ç´¢èƒ½åŠ›</li></ul><h4 id="ç­–ç•¥æ¢¯åº¦å®šç†">ç­–ç•¥æ¢¯åº¦å®šç†</h4><p>ç­–ç•¥ä¼˜åŒ–çš„æ•°å­¦åŸºç¡€æ¥è‡ªäºè‘—åçš„ç­–ç•¥æ¢¯åº¦å®šç†ï¼š</p><p><span class="math display">\[\nabla_\theta J(\theta) =\mathbb{E}_{\pi_\theta}[\nabla_\theta \log \pi_\theta(a|s) \cdotQ^{\pi_\theta}(s,a)]\]</span></p><p>è¿™ä¸ªå…¬å¼å‘Šè¯‰æˆ‘ä»¬ï¼šå¦‚æœæŸä¸ªåŠ¨ä½œçš„ä»·å€¼é«˜ï¼Œå°±å¢åŠ é€‰æ‹©å®ƒçš„æ¦‚ç‡ï¼›åä¹‹åˆ™é™ä½æ¦‚ç‡ã€‚</p><h4 id="å…¸å‹ç®—æ³•-1">å…¸å‹ç®—æ³•</h4><p><strong>REINFORCEç®—æ³•</strong>ï¼šæœ€åŸºç¡€çš„ç­–ç•¥æ¢¯åº¦æ–¹æ³•</p><ul><li>ä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ä¼°è®¡å›æŠ¥</li><li>ç®€å•ç›´æ¥ï¼Œä½†æ–¹å·®è¾ƒå¤§</li></ul><p><strong>PPO(Proximal PolicyOptimization)</strong>ï¼šç°ä»£ç­–ç•¥ä¼˜åŒ–çš„ä»£è¡¨</p><ul><li>é€šè¿‡â€ä¿¡ä»»åŒºåŸŸâ€æ€æƒ³æ§åˆ¶ç­–ç•¥æ›´æ–°å¹…åº¦</li><li>åœ¨æ ·æœ¬æ•ˆç‡å’Œç¨³å®šæ€§é—´å–å¾—è‰¯å¥½å¹³è¡¡</li></ul><h2 id="ä¸¤ç§æ–¹æ³•çš„æ·±åº¦å¯¹æ¯”">1.3 ä¸¤ç§æ–¹æ³•çš„æ·±åº¦å¯¹æ¯”</h2><table><thead><tr><th>ç»´åº¦</th><th>åŸºäºå€¼å‡½æ•°</th><th>åŸºäºç­–ç•¥</th></tr></thead><tbody><tr><td><strong>åŠ¨ä½œç©ºé—´</strong></td><td>é€‚åˆç¦»æ•£åŠ¨ä½œ</td><td>å¤©ç„¶æ”¯æŒè¿ç»­åŠ¨ä½œ</td></tr><tr><td><strong>ç­–ç•¥å¤æ‚åº¦</strong></td><td>ç®€å•ç¡®å®šæ€§ç­–ç•¥</td><td>æ”¯æŒå¤æ‚éšæœºç­–ç•¥</td></tr><tr><td><strong>æ ·æœ¬æ•ˆç‡</strong></td><td>é€šå¸¸è¾ƒé«˜</td><td>ç›¸å¯¹è¾ƒä½</td></tr><tr><td><strong>æ¢ç´¢æœºåˆ¶</strong></td><td>éœ€è¦é¢å¤–è®¾è®¡(å¦‚Îµ-è´ªå¿ƒ)</td><td>ç­–ç•¥æœ¬èº«åŒ…å«æ¢ç´¢</td></tr></tbody></table><h4 id="å€¼å‡½æ•°æ–¹æ³•çš„ç‰¹ç‚¹">å€¼å‡½æ•°æ–¹æ³•çš„ç‰¹ç‚¹</h4><ul><li>æ ·æœ¬æ•ˆç‡é«˜ï¼Œèƒ½ä»æœ‰é™ç»éªŒä¸­é«˜æ•ˆå­¦ä¹ </li><li>ç†è®ºåŸºç¡€æ‰å®ï¼ŒåŸºäºè´å°”æ›¼æ–¹ç¨‹</li><li>åœ¨ç¦»æ•£åŠ¨ä½œç©ºé—´ä¸­è¡¨ç°ä¼˜å¼‚</li><li>éš¾ä»¥å¤„ç†è¿ç»­æˆ–é«˜ç»´åŠ¨ä½œç©ºé—´</li><li>éœ€è¦é¢å¤–æœºåˆ¶å¹³è¡¡æ¢ç´¢ä¸åˆ©ç”¨</li><li>å‡½æ•°è¿‘ä¼¼å¯èƒ½å¯¼è‡´ä¸ç¨³å®š</li></ul><h4 id="ç­–ç•¥æ–¹æ³•çš„ç‰¹ç‚¹">ç­–ç•¥æ–¹æ³•çš„ç‰¹ç‚¹</h4><ul><li>è‡ªç„¶å¤„ç†è¿ç»­åŠ¨ä½œç©ºé—´</li><li>ç­–ç•¥è¡¨è¾¾èƒ½åŠ›å¼ºï¼Œå¯å­¦ä¹ å¤æ‚è¡Œä¸º</li><li>æ”¶æ•›æ€§ä¿è¯è¾ƒå¥½ï¼ˆåœ¨åˆé€‚æ¡ä»¶ä¸‹ï¼‰</li><li>æ ·æœ¬éœ€æ±‚é‡å¤§</li><li>æ¢¯åº¦ä¼°è®¡æ–¹å·®é«˜ï¼Œéœ€è¦é™æ–¹å·®æŠ€å·§</li><li>å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜</li></ul><h3 id="èåˆä¹‹é“actor-criticæ–¹æ³•">1.4 èåˆä¹‹é“ï¼šActor-Criticæ–¹æ³•</h3><p>æ—¢ç„¶ä¸¤ç§æ–¹æ³•å„æœ‰æ‰€é•¿ï¼Œè‡ªç„¶æœ‰äººæƒ³åˆ°å°†å®ƒä»¬ç»“åˆèµ·æ¥ã€‚è¿™å°±æ˜¯<strong>Actor-Criticæ–¹æ³•</strong>çš„æ ¸å¿ƒæ€æƒ³ï¼š</p><ul><li><strong>Actor(æ¼”å‘˜)</strong>ï¼šåŸºäºç­–ç•¥çš„ç»„ä»¶ï¼Œè´Ÿè´£é€‰æ‹©åŠ¨ä½œ</li><li><strong>Critic(è¯„è®ºå®¶)</strong>ï¼šåŸºäºå€¼å‡½æ•°çš„ç»„ä»¶ï¼Œè´Ÿè´£è¯„ä¼°åŠ¨ä½œä»·å€¼</li></ul><p>è¿™ç§ç»“åˆå¸¦æ¥äº†æ˜¾è‘—ä¼˜åŠ¿ï¼š</p><ol type="1"><li>Criticå¸®åŠ©Actorå‡å°‘æ¢¯åº¦æ–¹å·®</li><li>Actorä¸ºCriticæä¾›æ›´å¥½çš„æ¢ç´¢ç­–ç•¥</li><li>ä¸¤è€…ç›¸äº’ä¿ƒè¿›ï¼ŒåŠ é€Ÿæ”¶æ•›</li></ol><h2 id="åŠ¨æ€è§„åˆ’ä¸­çš„ç»å…¸å¯¹å†³ç­–ç•¥è¿­ä»£-vs-ä»·å€¼è¿­ä»£">2.åŠ¨æ€è§„åˆ’ä¸­çš„ç»å…¸å¯¹å†³ï¼šç­–ç•¥è¿­ä»£ vs ä»·å€¼è¿­ä»£</h2><p>åœ¨åŸºäºå€¼å‡½æ•°çš„æ–¹æ³•ä¸­ï¼ŒåŠ¨æ€è§„åˆ’æä¾›äº†ä¸¤ç§ç»å…¸çš„æ±‚è§£æ€è·¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç­–ç•¥è¿­ä»£å’Œä»·å€¼è¿­ä»£éƒ½å±äº<strong>åŸºäºå€¼å‡½æ•°</strong>çš„æ–¹æ³•ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºå¦‚ä½•åˆ©ç”¨å€¼å‡½æ•°æ¥ä¼˜åŒ–ç­–ç•¥ã€‚</p><h3 id="ç­–ç•¥è¿­ä»£">2.1 ç­–ç•¥è¿­ä»£</h3><p>ç­–ç•¥è¿­ä»£æ˜¯ä¸€ç§é€šè¿‡ä¸æ–­äº¤æ›¿æ‰§è¡Œ<strong>ç­–ç•¥è¯„ä¼°</strong>å’Œ<strong>ç­–ç•¥æ”¹è¿›</strong>æ¥æ‰¾åˆ°æœ€ä¼˜ç­–ç•¥çš„æ–¹æ³•ã€‚</p><ul><li><strong>ç­–ç•¥è¯„ä¼°</strong>ï¼šå›ºå®šå½“å‰ç­–ç•¥ï¼Œè®¡ç®—è¯¥ç­–ç•¥ä¸‹æ‰€æœ‰çŠ¶æ€çš„å€¼å‡½æ•°(V^(s))ï¼Œå³è¯„ä¼°åœ¨å½“å‰ç­–ç•¥ä¸‹ï¼Œæ¯ä¸ªçŠ¶æ€çš„é•¿æœŸå¥–åŠ±ã€‚</li><li><strong>ç­–ç•¥æ”¹è¿›</strong>ï¼šåˆ©ç”¨è¯„ä¼°å‡ºçš„å€¼å‡½æ•°ï¼Œæ”¹è¿›å½“å‰ç­–ç•¥ï¼Œå³åœ¨æ¯ä¸ªçŠ¶æ€ä¸‹é€‰æ‹©ä½¿å€¼å‡½æ•°æœ€å¤§çš„åŠ¨ä½œã€‚</li></ul><p>ç­–ç•¥è¿­ä»£çš„æ­¥éª¤æ˜¯ï¼š</p><ol type="1"><li>åˆå§‹åŒ–ç­–ç•¥ (_0)ã€‚</li><li>å¯¹ç­–ç•¥ (_i) è¿›è¡Œç­–ç•¥è¯„ä¼°ï¼Œè®¡ç®—å¯¹åº”çš„å€¼å‡½æ•° (V^{_i}(s))ã€‚</li><li>åŸºäº (V^{<em>i}(s)) æ”¹è¿›ç­–ç•¥ï¼Œå¾—åˆ°æ–°çš„ç­–ç•¥ (</em>{i+1})ã€‚</li><li>é‡å¤æ­¥éª¤ 2 å’Œ 3ï¼Œç›´åˆ°ç­–ç•¥æ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥ (^*)ã€‚</li></ol><h3 id="ä»·å€¼è¿­ä»£">2.2 ä»·å€¼è¿­ä»£</h3><p>ä»·å€¼è¿­ä»£é€šè¿‡ç›´æ¥æ›´æ–°å€¼å‡½æ•°çš„æ–¹å¼æ¥è¿­ä»£é€¼è¿‘æœ€ä¼˜å€¼å‡½æ•°(V^*(s))ï¼Œç„¶åé€šè¿‡å€¼å‡½æ•°å¯¼å‡ºç­–ç•¥ã€‚</p><ul><li>æ¯ä¸€æ­¥éƒ½ä¼šå¯¹æ¯ä¸ªçŠ¶æ€ (s) æ›´æ–°å…¶å€¼å‡½æ•°ä¸ºæœ€å¤§åŒ–é¢„æœŸå¥–åŠ±çš„å€¼</li><li>é€šè¿‡ä¸æ–­æ›´æ–°å€¼å‡½æ•°ï¼Œé€æ­¥é€¼è¿‘æœ€ä¼˜å€¼å‡½æ•°ã€‚å½“å€¼å‡½æ•°æ”¶æ•›æ—¶ï¼Œå¯ä»¥é€šè¿‡é€‰æ‹©æœ€å¤§åŒ–å€¼å‡½æ•°çš„åŠ¨ä½œæ¥è·å¾—æœ€ä¼˜ç­–ç•¥ã€‚</li></ul><p>ä»·å€¼è¿­ä»£çš„æ­¥éª¤æ˜¯ï¼š</p><ol type="1"><li>åˆå§‹åŒ–å€¼å‡½æ•° (V_0(s))ã€‚</li><li>å¯¹æ¯ä¸ªçŠ¶æ€ (s)ï¼Œæ›´æ–°å€¼å‡½æ•° (V_{i+1}(s))ï¼Œä½¿å…¶æœ€å¤§åŒ–é¢„æœŸå›æŠ¥ã€‚</li><li>é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°å€¼å‡½æ•°æ”¶æ•›ã€‚</li><li>å½“å€¼å‡½æ•°æ”¶æ•›åï¼Œé€šè¿‡é€‰æ‹©ä½¿ (V(s)) æœ€å¤§çš„åŠ¨ä½œ(a)ï¼Œå¯¼å‡ºæœ€ä¼˜ç­–ç•¥ã€‚</li></ol><h3 id="ç­–ç•¥è¿­ä»£-vs-ä»·å€¼è¿­ä»£">2.3 ç­–ç•¥è¿­ä»£ vs ä»·å€¼è¿­ä»£</h3><ul><li><strong>ç­–ç•¥è¿­ä»£</strong>ï¼šäº¤æ›¿æ‰§è¡Œå®Œæ•´çš„ç­–ç•¥è¯„ä¼°å’Œç­–ç•¥æ”¹è¿›ï¼Œè®¡ç®—è¾ƒç²¾ç¡®çš„ç­–ç•¥æ›´æ–°ï¼Œé€šå¸¸æ”¶æ•›è¾ƒå¿«ï¼Œä½†æ¯æ¬¡è¯„ä¼°éœ€è¦èŠ±è´¹è¾ƒå¤šæ—¶é—´ã€‚</li><li><strong>ä»·å€¼è¿­ä»£</strong>ï¼šåœ¨æ›´æ–°å€¼å‡½æ•°çš„åŒæ—¶éšå¼ä¼˜åŒ–ç­–ç•¥ï¼Œæ¯æ¬¡æ›´æ–°çš„ç²’åº¦è¾ƒå°ï¼Œè™½ç„¶æ›´æ–°é€Ÿåº¦å¿«ï¼Œä½†å¯èƒ½éœ€è¦æ›´å¤šè¿­ä»£æ¬¡æ•°æ‰èƒ½è¾¾åˆ°æ”¶æ•›ã€‚</li></ul><table><thead><tr><th style="text-align: center;">ç‰¹æ€§</th><th style="text-align: center;">ç­–ç•¥è¿­ä»£</th><th style="text-align: center;">ä»·å€¼è¿­ä»£</th></tr></thead><tbody><tr><td style="text-align: center;">è¿­ä»£æ­¥éª¤</td><td style="text-align: center;">ç­–ç•¥è¯„ä¼° + ç­–ç•¥æ”¹è¿›</td><td style="text-align: center;">å€¼å‡½æ•°æ›´æ–°</td></tr><tr><td style="text-align: center;">æ¯æ¬¡è¿­ä»£æˆæœ¬</td><td style="text-align: center;">é«˜</td><td style="text-align: center;">ä½</td></tr><tr><td style="text-align: center;">è¿­ä»£æ¬¡æ•°</td><td style="text-align: center;">å°‘</td><td style="text-align: center;">å¤š</td></tr><tr><td style="text-align: center;">æ”¶æ•›é€Ÿåº¦</td><td style="text-align: center;">å¿«</td><td style="text-align: center;">æ…¢</td></tr><tr><td style="text-align: center;">é€‚ç”¨åœºæ™¯</td><td style="text-align: center;">å°å‹ MDPï¼Œéœ€ç²¾ç¡®è§£</td><td style="text-align: center;">å¤§å‹ MDPï¼Œéœ€å¿«é€Ÿè¿‘ä¼¼</td></tr><tr><td style="text-align: center;">ç¨³å®šæ€§</td><td style="text-align: center;">é«˜</td><td style="text-align: center;">å¯èƒ½éœ‡è¡ï¼Œéœ€è¦è°ƒèŠ‚å‚æ•°</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åŸºäºå€¼å‡½æ•°-vs-åŸºäºç­–ç•¥æ–¹æ³•&quot;&gt;1. åŸºäºå€¼å‡½æ•° vs åŸºäºç­–ç•¥æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;å¼ºåŒ–å­¦ä¹ è§£å†³å†³ç­–é—®é¢˜çš„æ€è·¯å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šä¸€ç±»æ˜¯â€è¯„ä¼°ä»·å€¼åå†³ç­–â€ï¼Œå¦ä¸€ç±»æ˜¯â€ç›´æ¥ä¼˜åŒ–å†³ç­–â€ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„&lt;strong&gt;åŸºäºå€¼å‡½æ•°çš„æ–¹æ³•&lt;/strong&gt;å’Œ&lt;strong</summary>
      
    
    
    
    <category term="å¼ºåŒ–å­¦ä¹ " scheme="https://blog.keaikeqing.cn/categories/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
  <entry>
    <title>å¼ºåŒ–å­¦ä¹ â€”â€” 12 DDPGç®—æ³•</title>
    <link href="https://blog.keaikeqing.cn/2024/09/17/RL/12%20DDPG%E7%AE%97%E6%B3%95/"/>
    <id>https://blog.keaikeqing.cn/2024/09/17/RL/12%20DDPG%E7%AE%97%E6%B3%95/</id>
    <published>2024-09-17T11:40:43.000Z</published>
    <updated>2025-05-29T01:40:43.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ddpgç®—æ³•">12 DDPGç®—æ³•</h2><p>æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦æ˜¯åœ¨åŠ¨ä½œç©ºé—´æ— é™çš„ç¯å¢ƒä½¿ç”¨off-policyçš„actor-criticç®—æ³•ã€‚å®ƒå®ƒçš„actoræ˜¯ä¸€ä¸ªç¡®å®šæ€§ç­–ç•¥ï¼Œé€šè¿‡æ¢¯åº¦ä¸Šå‡æ³•æ¥æœ€å¤§åŒ–Qå€¼ï¼›å®ƒçš„criticæ˜¯ä¸€ä¸ªQç½‘ç»œï¼Œé€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ¥æœ€å°åŒ–Qå€¼çš„TDè¯¯å·®ã€‚</p><h3 id="ddpgç®—æ³•-1">12.1 DDPGç®—æ³•</h3><h4 id="ç®—æ³•å¼•å‡º">12.1.1 ç®—æ³•å¼•å‡º</h4><ol type="1"><li>TRPOå’ŒPPOæ˜¯on-policyçš„actor-criticç®—æ³•ï¼Œè¿™æ„å‘³ç€å®ƒä»¬åªèƒ½åœ¨å½“å‰ç­–ç•¥ä¸Šè¿›è¡Œæ›´æ–°ï¼Œæ ·æœ¬æ•ˆç‡è¾ƒä½ã€‚</li><li>DQNæ˜¯off-policyçš„Q-learningç®—æ³•ï¼Œç›´æ¥ä¼°è®¡Qå€¼ï¼Œæ ·æœ¬æ•ˆç‡è¾ƒé«˜ï¼Œä½†æ˜¯ä½†æ˜¯å®ƒåªèƒ½å¤„ç†åŠ¨ä½œç©ºé—´æœ‰é™çš„ç¯å¢ƒï¼Œè¿™æ˜¯å› ä¸ºå®ƒéœ€è¦ä»æ‰€æœ‰åŠ¨ä½œä¸­æŒ‘é€‰ä¸€ä¸ª<spanclass="math inline">\(Q\)</span>å€¼æœ€å¤§çš„åŠ¨ä½œã€‚è™½ç„¶å¯ä»¥å°†å°†åŠ¨ä½œç©ºé—´ç¦»æ•£åŒ–ï¼Œä½†è¿™æ¯”è¾ƒç²—ç³™ï¼Œæ— æ³•ç²¾ç»†æ§åˆ¶ã€‚</li><li>TRPOå’ŒPPOå­¦ä¹ çš„æ˜¯éšæœºç­–ç•¥ï¼Œè€ŒDDPGå­¦ä¹ çš„ç¡®å®šæ€§ç­–ç•¥ã€‚éšæœºç­–ç•¥å¯ä»¥è¡¨ç¤ºä¸º<spanclass="math inline">\(a\sim\pi_\theta(a|s)\)</span>ï¼Œç¡®å®šæ€§ç­–ç•¥å¯ä»¥è¡¨ç¤ºä¸º<spanclass="math inline">\(a=\mu_\theta(s)\)</span>ã€‚</li></ol><h4 id="ç®—æ³•å…¬å¼">12.1.2 ç®—æ³•å…¬å¼</h4><p>ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦å®šç†ï¼š</p><p><span class="math display">\[\nabla_\theta J(\mu_\theta)=\mathbb{E}_{s\sim \rho_\mu,a\sim\mu_\theta}[\nabla_\theta \mu_\theta(s)\nabla_aQ_\phi(s,a)|_{a=\mu_\theta(s)}]\]</span></p><p><strong>è¿™ä¸ªå…¬å¼å¯ä»¥ç†è§£ä¸º</strong>ï¼šå‡å®šç°åœ¨å·²æœ‰å‡½æ•°<spanclass="math inline">\(Q\)</span>ï¼Œç»™å®šä¸€ä¸ªçŠ¶æ€<spanclass="math inline">\(s\)</span>ï¼Œä½†ç”±äºç°åœ¨åŠ¨ä½œç©ºé—´æ˜¯æ— é™çš„ï¼Œæ‰€ä»¥æ— æ³•éå†æ‰€æœ‰åŠ¨ä½œæ¥å¾—åˆ°æœ€å¤§çš„<spanclass="math inline">\(Q\)</span>å€¼ï¼Œå› æ­¤æˆ‘ä»¬ç”¨ç­–ç•¥<spanclass="math inline">\(\mu_\theta(s)\)</span>æ¥æ‰¾åˆ°ä¸€ä¸ªåŠ¨ä½œ<spanclass="math inline">\(a\)</span>ï¼Œä½¿å¾—<spanclass="math inline">\(Q(s,a)\)</span>æœ€å¤§ã€‚æ­¤æ—¶ï¼Œ<spanclass="math inline">\(Q\)</span>å°±æ˜¯critic,<spanclass="math inline">\(\mu_\theta(s)\)</span>å°±æ˜¯actorã€‚</p><h4 id="ç®—æ³•æè¿°">12.1.3 ç®—æ³•æè¿°</h4><p>DDPGè¦ç”¨åˆ°4ä¸ªç½‘ç»œï¼š<spanclass="math inline">\(\mu,\mu&#39;,Q,Q&#39;\)</span>ã€‚å…¶ä¸­<spanclass="math inline">\(\mu\)</span>æ˜¯actorï¼Œ<spanclass="math inline">\(Q\)</span>æ˜¯criticï¼Œ<spanclass="math inline">\(\mu&#39;\)</span>æ˜¯actorçš„targetç½‘ç»œï¼Œ<spanclass="math inline">\(Q&#39;\)</span>æ˜¯criticçš„targetç½‘ç»œã€‚</p><p>ç›®æ ‡ç½‘ç»œçš„çš„æ›´æ–°æ–¹å¼æ˜¯<strong>è½¯æ›´æ–°</strong>ï¼š <spanclass="math display">\[\omega^-=\tau\omega+(1-\tau)\omega^-\]</span> å…¶ä¸­<spanclass="math inline">\(\tau\)</span>æ˜¯æ›´æ–°ç³»æ•°ï¼Œé€šå¸¸å¾ˆå°çš„ä¸€ä¸ªæ•°ã€‚å½“<spanclass="math inline">\(\tau = 1\)</span>æ—¶ï¼Œå°±å’ŒDQNæ›´æ–°æ–¹å¼ä¸€æ ·äº†ã€‚</p><p>å¦å¤–ï¼Œç”±äºå‡½æ•°<span class="math inline">\(Q\)</span>å­˜åœ¨<spanclass="math inline">\(Q\)</span>å€¼ä¼°å€¼è¿‡é«˜çš„é—®é¢˜ï¼ŒDDPG é‡‡ç”¨äº† Double DQNä¸­çš„æŠ€æœ¯æ¥æ›´æ–°<span class="math inline">\(Q\)</span>ç½‘ç»œã€‚ ä½†æ˜¯ï¼Œç”±äºDDPGé‡‡ç”¨çš„æ˜¯ç¡®å®šæ€§ç­–ç•¥ï¼Œå®ƒæœ¬èº«çš„æ¢ç´¢ä»ç„¶ååˆ†æœ‰é™ã€‚ä½œä¸ºä¸€ç§ç¦»çº¿ç­–ç•¥çš„ç®—æ³•ï¼ŒDDPGåœ¨è¡Œä¸ºç­–ç•¥ä¸Š<strong>å¼•å…¥ä¸€ä¸ªéšæœºå™ªå£°<spanclass="math inline">\(\mathcal{N}\)</span>æ¥è¿›è¡Œæ¢ç´¢</strong>ã€‚</p><h4 id="ç®—æ³•æµç¨‹">12.1.4 ç®—æ³•æµç¨‹</h4><ol type="1"><li>éšæœºåˆå§‹åŒ–actorå’Œcriticçš„ç½‘ç»œå‚æ•°<spanclass="math inline">\(\theta\)</span>å’Œ<spanclass="math inline">\(\omega\)</span>ï¼Œåˆå§‹åŒ–å™ªå£°è¿‡ç¨‹<spanclass="math inline">\(\mathcal{N}\)</span>ã€‚</li><li>å¤åˆ¶<span class="math inline">\(\theta\)</span>å’Œ<spanclass="math inline">\(\omega\)</span>åˆ°<spanclass="math inline">\(\theta^-\)</span>å’Œ<spanclass="math inline">\(\omega^-\)</span>ï¼Œåˆå§‹åŒ–ç›®æ ‡ç½‘ç»œã€‚</li><li>åˆå§‹åŒ–ç»éªŒå›æ”¾æ± <spanclass="math inline">\(\mathcal{D}\)</span>ã€‚</li><li>for è½®æ¬¡<span class="math inline">\(episode=1,2,...,E\)</span> do<ul><li>åˆå§‹åŒ–éšæœºè¿‡ç¨‹<spanclass="math inline">\(\mathcal{N}\)</span>ç”¨æ¥æ¢ç´¢ã€‚</li><li>è·å–ç¯å¢ƒåˆå§‹çŠ¶æ€<span class="math inline">\(s_1\)</span>ã€‚</li><li>for æ—¶é—´æ­¥ t=1,2,â€¦,T do<ul><li>æ ¹æ®å½“å‰ç­–ç•¥å’Œå™ªå£°é€‰æ‹©åŠ¨ä½œ<span class="math inline">\(a_t =\mu_\theta(s_t)+\mathcal{N}\)</span>ã€‚</li><li>æ‰§è¡ŒåŠ¨ä½œ<span class="math inline">\(a_t\)</span>ï¼Œå¾—åˆ°æ–°çŠ¶æ€<spanclass="math inline">\(s_{t+1}\)</span>ï¼Œå¥–åŠ±<spanclass="math inline">\(r_t\)</span>ã€‚</li><li>å°†<spanclass="math inline">\((s_t,a_t,r_t,s_{t+1})\)</span>å­˜å…¥<spanclass="math inline">\(\mathcal{D}\)</span>ã€‚</li><li>ä»<span class="math inline">\(\mathcal{D}\)</span>ä¸­éšæœºé‡‡æ ·<spanclass="math inline">\(N\)</span>ä¸ªæ ·æœ¬<spanclass="math inline">\({(s_i,a_i,r_i,s_{i+1})}_{i=1,2,...,N}\)</span>ã€‚</li><li>å¯¹æ¯ä¸ªæ ·æœ¬<spanclass="math inline">\(i\)</span>ï¼Œç”¨ç›®æ ‡ç½‘ç»œè®¡ç®—<spanclass="math inline">\(y_i=r_i+\gammaQ_\phi(s_{i+1},\mu_\theta(s_{i+1}))\)</span>ã€‚</li><li>æœ€å°åŒ–ç›®æ ‡æŸå¤±å‡½æ•°<spanclass="math inline">\(L(\omega)=\frac{1}{N}\sum_i(y_i-Q_\omega(s_i,a_i))^2\)</span>ï¼Œæ›´æ–°å½“å‰criticç½‘ç»œå‚æ•°<spanclass="math inline">\(\omega\)</span>ã€‚</li><li>è®¡ç®—é‡‡æ ·çš„<spanclass="math inline">\(N\)</span>ä¸ªåŠ¨ä½œçš„ç­–ç•¥æ¢¯åº¦ï¼Œæ›´æ–°å½“å‰actorç½‘ç»œå‚æ•°<spanclass="math inline">\(\theta\)</span>ã€‚<spanclass="math inline">\(\nabla_\theta J \approx\frac{1}{N}\sum_i\nabla_\theta \mu_\theta(s_i)\nabla_aQ_\phi(s_i,a_i)|_{a=\mu_\theta(s_i)}\)</span></li><li>æ›´æ–°ç›®æ ‡ç½‘ç»œã€‚<spanclass="math inline">\(\omega^-=\tau\omega+(1-\tau)\omega^-,\theta^-=\tau\theta+(1-\tau)\theta^-\)</span>ã€‚</li></ul></li><li>end for</li></ul></li><li>end for</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ddpgç®—æ³•&quot;&gt;12 DDPGç®—æ³•&lt;/h2&gt;
&lt;p&gt;æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦æ˜¯åœ¨åŠ¨ä½œç©ºé—´æ— é™çš„ç¯å¢ƒä½¿ç”¨off-policyçš„actor-criticç®—æ³•ã€‚å®ƒå®ƒçš„actoræ˜¯ä¸€ä¸ªç¡®å®šæ€§ç­–ç•¥ï¼Œé€šè¿‡æ¢¯åº¦ä¸Šå‡æ³•æ¥æœ€å¤§åŒ–Qå€¼ï¼›å®ƒçš„criticæ˜¯ä¸€ä¸ªQç½‘ç»œï¼Œé€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ¥æœ€å°åŒ–Q</summary>
      
    
    
    
    <category term="å¼ºåŒ–å­¦ä¹ " scheme="https://blog.keaikeqing.cn/categories/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/"/>
    
    
  </entry>
  
</feed>
